<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <link type="text/css" rel="stylesheet" href="jspyder.css" />
    <script type="text/javascript" src="jspyder.js"></script>
    <script type="text/javascript" src="js-ajax.js"></script>
    <script type="text/javascript" src="js-dtype.js"></script>
    <script type="text/javascript" src="js-template.js"></script>
</head>

<body>
    <div id="test">This is a test div.</div>
    <div class="spread-3-1">
        <div>
            <label class="spread-3-1">Input Number</label class="spread-3-1">
            <input class="spread-3-2" id="input" />
        </div>
        <div>
            <label class="spread-3-1">BYTE</label class="spread-3-1">
            <input class="spread-3-2" id="out-byte" />
        </div>
        <div>
            <label class="spread-3-1">UBYTE</label class="spread-3-1">
            <input class="spread-3-2" id="out-ubyte" />
        </div>
        <div>
            <label class="spread-3-1">SHORT</label class="spread-3-1">
            <input class="spread-3-2" id="out-short" />
        </div>
        <div>
            <label class="spread-3-1">USHORT</label class="spread-3-1">
            <input class="spread-3-2" id="out-ushort" />
        </div>
        <div>
            <label class="spread-3-1">INT</label class="spread-3-1">
            <input class="spread-3-2" id="out-int" />
        </div>
        <div>
            <label class="spread-3-1">UINT</label class="spread-3-1">
            <input class="spread-3-2" id="out-uint" />
        </div>
        <div>
            <label class="spread-3-1">FLOAT</label class="spread-3-1">
            <input class="spread-3-2" id="out-float" />
        </div>
        <div>
            <label class="spread-3-1">DOUBLE</label class="spread-3-1">
            <input class="spread-3-2" id="out-double" />
        </div>
    </div>
    <br />
    <br />

    <script id="test-template" type="text/jspyder-template">
        <div class="my-template-div">
            @bold($name)
        </div>
    </script>

    <script type="text/javascript">
        js.dom("#input")
            .on("input", function(evt) {
                var value = this.value;
                
                js.dom("#out-byte").setAttrs({ "value": js.alg.byte(value) });
                js.dom("#out-ubyte").setAttrs({ "value": js.alg.ubyte(value) });
                js.dom("#out-short").setAttrs({ "value": js.alg.short(value) });
                js.dom("#out-ushort").setAttrs({ "value": js.alg.ushort(value) });
                js.dom("#out-int").setAttrs({ "value": js.alg.int(value) });
                js.dom("#out-uint").setAttrs({ "value": js.alg.uint(value) });
                js.dom("#out-float").setAttrs({ "value": js.alg.float(value) });
                js.dom("#out-double").setAttrs({ "value": js.alg.double(value) });
            });
            
        js.dom("#test")
            .on("mousedown", function(evt) { 
                console.log("mousedown"); 
            });
                
        js.dom("<button>Click Me to Click Text</button>")
            .attach(document.body)
            .on("mousedown", function(evt) {
                js.dom("#test").trigger("mousedown");
            });
        
        var o = {};
        js.dtype(o)
            .ubyte("ubyte", 0)
            .ubyte("subyte", 0, true)
            .ubyte("cubyte", 0, false, true)
            .ubyte("scubyte", 0, true, true)
            .uchar("uchar", 63)
            .uchar("suchar", 63, true)
            .uchar("cuchar", 63, false, true)
            .uchar("scuchar", 63, true, true)
            .string("string", "string")
            .string("sstring", "string", true)
            .string("cstring", "string", false, true)
            .string("scstring", "string", true, true);
            
        var $t = js.template({
            divisions: ["J2", "J2X", "J22", "J23", "J25", "J26", "J28", "J29"]
        });
        
        var projectedTravel = {
            table_header: "Projected Travel",
            table_class: "projected travel",
            table_columns: [
                {
                    tag: "division",
                    text: "Division"
                },
                {
                    tag: "fyq1",
                    text: "1<sup>st</sup> Quarter"
                },
                {
                    tag: "fyq2",
                    text: "2<sup>nd</sup> Quarter"
                },
                {
                    tag: "fyq3",
                    text: "3<sup>rd</sup> Quarter"
                },
                {
                    tag: "fyq4",
                    text: "4<sup>th</sup> Quarter"
                },
                {
                    tag: "fyTotal",
                    text: "Total"
                },
                {
                    tag: "fyRemaining",
                    text: "Remaining"
                }
            ],
            // ["Division", "Travel Budget", "1st Quarter", "2nd Quarter", "3rd Quarter", "4th Quarter", "Total", "Remaining"],
            table_rows: [
                { division: "J20", fyq1: 2000 }, 
                { division: "J2X", fyq1: 2100 }, 
                { division: "J22", fyq1: 2200 },
                { division: "J23", fyq1: 2300 }, 
                { division: "J25", fyq1: 2500 }, 
                { division: "J26", fyq1: 2600 }, 
                { division: "J28", fyq1: 2800 }, 
                { division: "J29", fyq1: 2900 }
            ]
        };
            
        js.ajax("tmp/templates.xml")
            .get(function(xhttp) {
                var $xml = js.dom(xhttp.responseXML.firstChild),
                    $template = js.template();
                    
                $xml.children(function(child) {
                    $template.storeTemplate(child.getAttribute("name"), child.innerHTML);
                });
                
                $t.compile("overview-table", projectedTravel, function(table) {
                    js.dom(document.body).append(table);
                    console.log(table);
                });
            });
        
    </script>
</body>

</html>