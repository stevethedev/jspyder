var $jscomp={scope:{},getGlobal:function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global?global:c}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return"jscomp_symbol_"+c+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};
$jscomp.makeIterator=function(c){$jscomp.initSymbolIterator();if(c[$jscomp.global.Symbol.iterator])return c[$jscomp.global.Symbol.iterator]();if(!(c instanceof Array||"string"==typeof c||c instanceof String))throw new TypeError(c+" is not iterable");var d=0;return{next:function(){return d==c.length?{done:!0}:{done:!1,value:c[d++]}}}};$jscomp.arrayFromIterator=function(c){for(var d,b=[];!(d=c.next()).done;)b.push(d.value);return b};
$jscomp.arrayFromIterable=function(c){return c instanceof Array?c:$jscomp.arrayFromIterator($jscomp.makeIterator(c))};$jscomp.arrayFromArguments=function(c){for(var d=[],b=0;b<c.length;b++)d.push(c[b]);return d};$jscomp.inherits=function(c,d){function b(){}b.prototype=d.prototype;c.prototype=new b;c.prototype.constructor=c;for(var a in d)if($jscomp.global.Object.defineProperties){var f=$jscomp.global.Object.getOwnPropertyDescriptor(d,a);$jscomp.global.Object.defineProperty(c,a,f)}else c[a]=d[a]};
$jscomp.array=$jscomp.array||{};$jscomp.array.done_=function(){return{done:!0,value:void 0}};$jscomp.array.arrayIterator_=function(c,d){c instanceof String&&(c=String(c));var b=0;$jscomp.initSymbol();$jscomp.initSymbolIterator();var a={},f=(a.next=function(){if(b<c.length){var a=b++;return{value:d(a,c[a]),done:!1}}f.next=$jscomp.array.done_;return $jscomp.array.done_()},a[Symbol.iterator]=function(){return f},a);return f};
$jscomp.array.findInternal_=function(c,d,b){c instanceof String&&(c=String(c));for(var a=c.length,f=0;f<a;f++){var e=c[f];if(d.call(b,e,f,c))return{i:f,v:e}}return{i:-1,v:void 0}};
$jscomp.array.from=function(c,d,b){d=void 0===d?function(a){return a}:d;var a=[];$jscomp.initSymbol();$jscomp.initSymbolIterator();if(c[Symbol.iterator]){$jscomp.initSymbol();$jscomp.initSymbolIterator();c=c[Symbol.iterator]();for(var f;!(f=c.next()).done;)a.push(d.call(b,f.value))}else{f=c.length;for(var e=0;e<f;e++)a.push(d.call(b,c[e]))}return a};$jscomp.array.of=function(c){for(var d=[],b=0;b<arguments.length;++b)d[b-0]=arguments[b];return $jscomp.array.from(d)};
$jscomp.array.entries=function(){return $jscomp.array.arrayIterator_(this,function(c,d){return[c,d]})};$jscomp.array.entries$install=function(){Array.prototype.entries||(Array.prototype.entries=$jscomp.array.entries)};$jscomp.array.keys=function(){return $jscomp.array.arrayIterator_(this,function(c){return c})};$jscomp.array.keys$install=function(){Array.prototype.keys||(Array.prototype.keys=$jscomp.array.keys)};$jscomp.array.values=function(){return $jscomp.array.arrayIterator_(this,function(c,d){return d})};
$jscomp.array.values$install=function(){Array.prototype.values||(Array.prototype.values=$jscomp.array.values)};$jscomp.array.copyWithin=function(c,d,b){var a=this.length;c=Number(c);d=Number(d);b=Number(null!=b?b:a);if(c<d)for(b=Math.min(b,a);d<b;)d in this?this[c++]=this[d++]:(delete this[c++],d++);else for(b=Math.min(b,a+d-c),c+=b-d;b>d;)--b in this?this[--c]=this[b]:delete this[c];return this};$jscomp.array.copyWithin$install=function(){Array.prototype.copyWithin||(Array.prototype.copyWithin=$jscomp.array.copyWithin)};
$jscomp.array.fill=function(c,d,b){null!=b&&c.length||(b=this.length||0);b=Number(b);for(d=Number((void 0===d?0:d)||0);d<b;d++)this[d]=c;return this};$jscomp.array.fill$install=function(){Array.prototype.fill||(Array.prototype.fill=$jscomp.array.fill)};$jscomp.array.find=function(c,d){return $jscomp.array.findInternal_(this,c,d).v};$jscomp.array.find$install=function(){Array.prototype.find||(Array.prototype.find=$jscomp.array.find)};
$jscomp.array.findIndex=function(c,d){return $jscomp.array.findInternal_(this,c,d).i};$jscomp.array.findIndex$install=function(){Array.prototype.findIndex||(Array.prototype.findIndex=$jscomp.array.findIndex)};$jscomp.Map=function(c){c=void 0===c?[]:c;this.data_={};this.head_=$jscomp.Map.createHead_();this.size=0;if(c){c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())d=d.value,this.set(d[0],d[1])}};
$jscomp.Map.checkBrowserConformance_=function(){var c=$jscomp.global.Map;if(!c||!c.prototype.entries||!Object.seal)return!1;try{var d=Object.seal({x:4}),b=new c($jscomp.makeIterator([[d,"s"]]));if("s"!=b.get(d)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var a=b.entries(),f=a.next();if(f.done||f.value[0]!=d||"s"!=f.value[1])return!1;f=a.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!a.next().done?!1:!0}catch(e){return!1}};
$jscomp.Map.createHead_=function(){var c={};return c.previous=c.next=c.head=c};$jscomp.Map.getId_=function(c){if(!(c instanceof Object))return String(c);$jscomp.Map.key_ in c||c instanceof Object&&Object.isExtensible&&Object.isExtensible(c)&&$jscomp.Map.defineProperty_(c,$jscomp.Map.key_,++$jscomp.Map.index_);return $jscomp.Map.key_ in c?c[$jscomp.Map.key_]:" "+c};
$jscomp.Map.prototype.set=function(c,d){var b=this.maybeGetEntry_(c),a=b.id,f=b.list,b=b.entry;f||(f=this.data_[a]=[]);b?b.value=d:(b={next:this.head_,previous:this.head_.previous,head:this.head_,key:c,value:d},f.push(b),this.head_.previous.next=b,this.head_.previous=b,this.size++);return this};
$jscomp.Map.prototype["delete"]=function(c){var d=this.maybeGetEntry_(c);c=d.id;var b=d.list,a=d.index;return(d=d.entry)&&b?(b.splice(a,1),b.length||delete this.data_[c],d.previous.next=d.next,d.next.previous=d.previous,d.head=null,this.size--,!0):!1};$jscomp.Map.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=$jscomp.Map.createHead_();this.size=0};$jscomp.Map.prototype.has=function(c){return!!this.maybeGetEntry_(c).entry};
$jscomp.Map.prototype.get=function(c){return(c=this.maybeGetEntry_(c).entry)&&c.value};$jscomp.Map.prototype.maybeGetEntry_=function(c){var d=$jscomp.Map.getId_(c),b=this.data_[d];if(b)for(var a=0;a<b.length;a++){var f=b[a];if(c!==c&&f.key!==f.key||c===f.key)return{id:d,list:b,index:a,entry:f}}return{id:d,list:b,index:-1,entry:void 0}};$jscomp.Map.prototype.entries=function(){return this.iter_(function(c){return[c.key,c.value]})};$jscomp.Map.prototype.keys=function(){return this.iter_(function(c){return c.key})};
$jscomp.Map.prototype.values=function(){return this.iter_(function(c){return c.value})};$jscomp.Map.prototype.forEach=function(c,d){for(var b=$jscomp.makeIterator(this.entries()),a=b.next();!a.done;a=b.next())a=a.value,c.call(d,a[1],a[0],this)};
$jscomp.Map.prototype.iter_=function(c){var d=this,b=this.head_;$jscomp.initSymbol();$jscomp.initSymbolIterator();var a={};return a.next=function(){if(b){for(;b.head!=d.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:c(b)};b=null}return{done:!0,value:void 0}},a[Symbol.iterator]=function(){return this},a};$jscomp.Map.index_=0;$jscomp.Map.defineProperty_=Object.defineProperty?function(c,d,b){Object.defineProperty(c,d,{value:String(b)})}:function(c,d,b){c[d]=String(b)};
$jscomp.Map.Entry_=function(){};$jscomp.Map.ASSUME_NO_NATIVE=!1;$jscomp.Map$install=function(){$jscomp.initSymbol();$jscomp.initSymbolIterator();!$jscomp.Map.ASSUME_NO_NATIVE&&$jscomp.Map.checkBrowserConformance_()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.Map.key_=Symbol("map-id-key"));$jscomp.Map$install=function(){}};$jscomp.math=$jscomp.math||{};
$jscomp.math.clz32=function(c){c=Number(c)>>>0;if(0===c)return 32;var d=0;0===(c&4294901760)&&(c<<=16,d+=16);0===(c&4278190080)&&(c<<=8,d+=8);0===(c&4026531840)&&(c<<=4,d+=4);0===(c&3221225472)&&(c<<=2,d+=2);0===(c&2147483648)&&d++;return d};$jscomp.math.imul=function(c,d){c=Number(c);d=Number(d);var b=c&65535,a=d&65535;return b*a+((c>>>16&65535)*a+b*(d>>>16&65535)<<16>>>0)|0};$jscomp.math.sign=function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1};
$jscomp.math.log10=function(c){return Math.log(c)/Math.LN10};$jscomp.math.log2=function(c){return Math.log(c)/Math.LN2};$jscomp.math.log1p=function(c){c=Number(c);if(.25>c&&-.25<c){for(var d=c,b=1,a=c,f=0,e=1;f!=a;)d*=c,e*=-1,a=(f=a)+e*d/++b;return a}return Math.log(1+c)};$jscomp.math.expm1=function(c){c=Number(c);if(.25>c&&-.25<c){for(var d=c,b=1,a=c,f=0;f!=a;)d*=c/++b,a=(f=a)+d;return a}return Math.exp(c)-1};$jscomp.math.cosh=function(c){c=Number(c);return(Math.exp(c)+Math.exp(-c))/2};
$jscomp.math.sinh=function(c){c=Number(c);return 0===c?c:(Math.exp(c)-Math.exp(-c))/2};$jscomp.math.tanh=function(c){c=Number(c);if(0===c)return c;var d=Math.exp(2*-Math.abs(c)),d=(1-d)/(1+d);return 0>c?-d:d};$jscomp.math.acosh=function(c){c=Number(c);return Math.log(c+Math.sqrt(c*c-1))};$jscomp.math.asinh=function(c){c=Number(c);if(0===c)return c;var d=Math.log(Math.abs(c)+Math.sqrt(c*c+1));return 0>c?-d:d};
$jscomp.math.atanh=function(c){c=Number(c);return($jscomp.math.log1p(c)-$jscomp.math.log1p(-c))/2};
$jscomp.math.hypot=function(c,d,b){for(var a=[],f=2;f<arguments.length;++f)a[f-2]=arguments[f];c=Number(c);d=Number(d);for(var e=Math.max(Math.abs(c),Math.abs(d)),g=$jscomp.makeIterator(a),f=g.next();!f.done;f=g.next())e=Math.max(e,Math.abs(f.value));if(1E100<e||1E-100>e){c/=e;d/=e;g=c*c+d*d;a=$jscomp.makeIterator(a);for(f=a.next();!f.done;f=a.next())f=f.value,f=Number(f)/e,g+=f*f;return Math.sqrt(g)*e}e=c*c+d*d;a=$jscomp.makeIterator(a);for(f=a.next();!f.done;f=a.next())f=f.value,e+=f*f;return Math.sqrt(e)};
$jscomp.math.trunc=function(c){c=Number(c);if(isNaN(c)||Infinity===c||-Infinity===c||0===c)return c;var d=Math.floor(Math.abs(c));return 0>c?-d:d};$jscomp.math.cbrt=function(c){if(0===c)return c;c=Number(c);var d=Math.pow(Math.abs(c),1/3);return 0>c?-d:d};$jscomp.number=$jscomp.number||{};$jscomp.number.isFinite=function(c){return"number"!==typeof c?!1:!isNaN(c)&&Infinity!==c&&-Infinity!==c};$jscomp.number.isInteger=function(c){return $jscomp.number.isFinite(c)?c===Math.floor(c):!1};
$jscomp.number.isNaN=function(c){return"number"===typeof c&&isNaN(c)};$jscomp.number.isSafeInteger=function(c){return $jscomp.number.isInteger(c)&&Math.abs(c)<=$jscomp.number.MAX_SAFE_INTEGER};$jscomp.number.EPSILON=Math.pow(2,-52);$jscomp.number.MAX_SAFE_INTEGER=9007199254740991;$jscomp.number.MIN_SAFE_INTEGER=-9007199254740991;$jscomp.object=$jscomp.object||{};
$jscomp.object.assign=function(c,d){for(var b=[],a=1;a<arguments.length;++a)b[a-1]=arguments[a];b=$jscomp.makeIterator(b);for(a=b.next();!a.done;a=b.next()){var a=a.value,f;for(f in a)Object.prototype.hasOwnProperty.call(a,f)&&(c[f]=a[f])}return c};$jscomp.object.is=function(c,d){return c===d?0!==c||1/c===1/d:c!==c&&d!==d};$jscomp.Set=function(c){c=void 0===c?[]:c;this.map_=new $jscomp.Map;if(c){c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())this.add(d.value)}this.size=this.map_.size};
$jscomp.Set.checkBrowserConformance_=function(){var c=$jscomp.global.Set;if(!c||!c.prototype.entries||!Object.seal)return!1;var d=Object.seal({x:4}),c=new c($jscomp.makeIterator([d]));if(c.has(d)||1!=c.size||c.add(d)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var c=c.entries(),b=c.next();if(b.done||b.value[0]!=d||b.value[1]!=d)return!1;b=c.next();return b.done||b.value[0]==d||4!=b.value[0].x||b.value[1]!=b.value[0]?!1:c.next().done};
$jscomp.Set.prototype.add=function(c){this.map_.set(c,c);this.size=this.map_.size;return this};$jscomp.Set.prototype["delete"]=function(c){c=this.map_["delete"](c);this.size=this.map_.size;return c};$jscomp.Set.prototype.clear=function(){this.map_.clear();this.size=0};$jscomp.Set.prototype.has=function(c){return this.map_.has(c)};$jscomp.Set.prototype.entries=function(){return this.map_.entries()};$jscomp.Set.prototype.values=function(){return this.map_.values()};
$jscomp.Set.prototype.forEach=function(c,d){var b=this;this.map_.forEach(function(a){return c.call(d,a,a,b)})};$jscomp.Set.ASSUME_NO_NATIVE=!1;$jscomp.Set$install=function(){!$jscomp.Set.ASSUME_NO_NATIVE&&$jscomp.Set.checkBrowserConformance_()?$jscomp.Set=$jscomp.global.Set:($jscomp.Map$install(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values);$jscomp.Set$install=function(){}};$jscomp.string=$jscomp.string||{};
$jscomp.string.noRegExp_=function(c,d){if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");};
$jscomp.string.fromCodePoint=function(c){for(var d=[],b=0;b<arguments.length;++b)d[b-0]=arguments[b];for(var b="",d=$jscomp.makeIterator(d),a=d.next();!a.done;a=d.next()){a=a.value;a=+a;if(0>a||1114111<a||a!==Math.floor(a))throw new RangeError("invalid_code_point "+a);65535>=a?b+=String.fromCharCode(a):(a-=65536,b+=String.fromCharCode(a>>>10&1023|55296),b+=String.fromCharCode(a&1023|56320))}return b};
$jscomp.string.repeat=function(c){var d=this.toString();if(0>c||1342177279<c)throw new RangeError("Invalid count value");c|=0;for(var b="";c;)if(c&1&&(b+=d),c>>>=1)d+=d;return b};$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)};
$jscomp.string.codePointAt=function(c){var d=this.toString(),b=d.length;c=Number(c)||0;if(0<=c&&c<b){c|=0;var a=d.charCodeAt(c);if(55296>a||56319<a||c+1===b)return a;c=d.charCodeAt(c+1);return 56320>c||57343<c?a:1024*(a-55296)+c+9216}};$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)};
$jscomp.string.includes=function(c,d){d=void 0===d?0:d;$jscomp.string.noRegExp_(c,"includes");return-1!==this.toString().indexOf(c,d)};$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)};
$jscomp.string.startsWith=function(c,d){d=void 0===d?0:d;$jscomp.string.noRegExp_(c,"startsWith");var b=this.toString();c+="";for(var a=b.length,f=c.length,e=Math.max(0,Math.min(d|0,b.length)),g=0;g<f&&e<a;)if(b[e++]!=c[g++])return!1;return g>=f};$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)};
$jscomp.string.endsWith=function(c,d){$jscomp.string.noRegExp_(c,"endsWith");var b=this.toString();c+="";void 0===d&&(d=b.length);for(var a=Math.max(0,Math.min(d|0,b.length)),f=c.length;0<f&&0<a;)if(b[--a]!=c[--f])return!1;return 0>=f};$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};
(function(c,d){function b(b){var c=b.jspyder=function(){};c.extend=function(a,b){this.hasOwnProperty(a)||Object.defineProperty(this,a,{value:b});return this};c.extend.fn=function(a,b,d){c.extend(a,b.apply(c,d));return this};c.createRegistry=k;c.registry=k();a(c);f(c);q(c);e(c);g(c);c.loadScript=function(a){c.ajax(a).get(function(a){(new Function(a.responseText))()})};return c}function a(a){function b(c,d){var f=a.alg.sliceArray(arguments,1<arguments.length?1:0),h,v,n;if(1===arguments.length||arguments)c=
0;console&&(n=console.log||function(){},v=console.warn||n,h=console.error||h,2===c?a.alg.use(console,h,f):1===c?a.alg.use(console,v,f):a.alg.use(console,n,f));return this}b.err=function(c){a.alg.use(a,b,[2].concat(a.alg.sliceArray(arguments,0)));return this};b.warn=function(c){a.alg.use(a,b,[1].concat(a.alg.sliceArray(arguments,0)));return this};a.extend("log",b)}function f(a){var b="",c=0;(function(){t.documentMode?(b="IE",c=window.attachEvent?eval("/*@cc_on (document.documentMode == 10)!=@*/false")?
10:window.requestAnimationFrame?window.addEventListener?7:8:9:11):"undefined"!==typeof window.InstallTrigger?(b="Firefox",c=Int8Array&&Int8Array.prototype.sort?7:Node.innerText?45:Document.charset?44:Array.prototype.includes?43:"undefined"!==typeof window.Reflect?42:41):window.opera||0<=navigator.userAgent.indexOf(" OPR/")?(b="Opera",c=1):window.chrome?(b="Chrome",c=45):0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")?(b="Safari",window.CSS.supports?c=9:window.CSS.supports||
(c=8)):window.MSInputMethodContext?(b="Edge",$jscomp.initSymbol(),c="{}"===JSON.stringify({foo:Symbol()})?13:window.RTCIceGatherOptions?11:12):/iP(ad|hone|od)/.test(navigator.userAgent)?(b="iOS Safari",c=8.4):window.operamini?(b="Opera Mini",c=8):/Android.*Mozilla\/5.0.*AppleWebKit/.test(navigator.userAgent)?(b="Android Browser",c=4.3):/Android.*Chrome/.test(navigator.userAgent)&&(b="Chrome for Android",c=47)})();var d={name:b,version:c,toString:function(){return this.name+this.version}};Object.freeze(d);
d={version:"0.2.0",versionNo:512,browser:d};Object.freeze(d);a.extend("env",d)}function e(a){var b;if(a.alg)return a.alg;b={each:function(b,c,d){var h={stop:function(){v=!0;return this},drop:function(h){return this}},v=!1;if(b&&"object"===typeof b)for(var n in b)if(c.apply(h,[b[n],n,b,d]),v)break;return a},arrEach:function(b,c,d){var h={stop:function(){v=!0;return this},drop:function(h){b instanceof Array&&b.splice(n--,a.alg.number(h,1));return this}},v=!1;if(b&&"object"===typeof b)for(var n=0;n<
b.length&&(c.apply(h,[b[n],n,b,d]),!v);n++);return a},iterate:function(b,c,d,h){b=a.alg.number(b);c=a.alg.number(c);for(var v={stop:function(){n=!0;return this},drop:function(h){return this}},n=!1,f=c<b?-1:1;b!==c&&(d.apply(v,[b,h]),!n);b+=f);return a},magnitude:function(b){b=a.alg.number(b);var c=Math.pow(10,((0>b?-b:b)|0).toString().length-1);return Math[0>b?"floor":"ceil"](b/c)*c},escapeString:function(b){return a.alg.string(b).replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},use:function(a,
b,c){a||(a=null);return"function"===typeof b?b.apply(a,c):void 0},run:function(a){"function"===typeof a&&a();return this},bool:function(a,b){switch(typeof a){case "undefined":return b||!1;case "string":return/true/i.test(a)}return a?!0:!1},number:function(a,b){var c=+a;return c==a||c===c?c:b||0},string:function(a,b){return"string"===typeof a?a:a&&"function"===typeof a.toString?a.toString():null!==a&&"object"===typeof a&&a.isPrototypeOf(RegExp)?a=(""+a).match(/^\/(.*)\/[a-z]*$/,"$1"):a||0===a?""+a:
b||""},object:function(a,b){return a&&"object"===typeof a?a:b||{}},array:function(a,b){return Array.isArray(a)?a:b||[]},date:function(a,b){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)?a:b||new Date},"byte":function(c){b["byte"]="undefined"===typeof Int8Array?function(b){b=a.alg.number(b);for(b=(b===b?b:0)&255;-128>b;)b+=256;for(;127<b;)b-=256;return b}:function(a){var b=new ArrayBuffer(1),b=new Int8Array(b);b[0]=a;return b[0]};return b["byte"](c)},ubyte:function(a){b.ubyte=
"undefined"===typeof Uint8Array?function(a){a=+a;return(a===a?a:0)&255}:function(a){var b=new ArrayBuffer(1),b=new Uint8Array(b);b[0]=a;return b[0]};return b.ubyte(a)},"short":function(a){b["short"]="undefined"===typeof Int16Array?function(a){a=+a;for(a=(a===a?a:0)&65535;-32768>a;)a+=65536;for(;32767<a;)a-=65536;return a}:function(a){var b=new ArrayBuffer(2),b=new Int16Array(b);b[0]=a;return b[0]};return b["short"](a)},ushort:function(a){b.ushort="undefined"===typeof Uint16Array?function(a){a=+a;
return(a===a?a:0)&65535}:function(a){var b=new ArrayBuffer(2),b=new Uint16Array(b);b[0]=a;return b[0]};return b.ushort(a)},"int":function(a){b["int"]="undefined"===typeof Int32Array?function(a){a=+a;for(a=(a===a?a:0)&4294967295;-2147483648>a;)a+=4294967296;for(;2147483647<a;)a-=4294967296;return a}:function(a){var b=new ArrayBuffer(4),b=new Int32Array(b);b[0]=a;return b[0]};return b["int"](a)},uint:function(a){b.uint="undefined"===typeof Int32Array?function(a){a=+a;a=(a===a?a:0)%4294967296;return 0>
a?-1*a:a}:function(a){var b=new ArrayBuffer(4),b=new Uint32Array(b);b[0]=a;return b[0]};return b.uint(a)},"float":function(a){b["float"]="undefined"===typeof window.Float32Array?function(a){for(var b=0<a?1:-1,h=0,c=a*b,d=0;2<=c||1>c;)2<=c&&(c/=2,h++),1>c&&(c*=2,h--);d=a/Math.pow(2,h)-1;d=1+Math.round(8388608*d)/8388608;return+(b*d*Math.pow(2,h)).toPrecision(8)}:function(a){var b=new ArrayBuffer(4),b=new Float32Array(b);b[0]=a;return+b[0].toPrecision(8)};return b["float"](a)},"double":function(a){b["double"]=
"undefined"===typeof Float64Array?function(a){a=+(+a).toPrecision(16);return a==a?a:0}:function(a){var b=new ArrayBuffer(8),b=new Float64Array(b);b[0]=a;return b[0]};return b["double"](a)},makeEnum:function(b,c){c=c||{};var d=1;a.alg.arrEach(b,function(a,b){c[a]=d;d*=2});return c},rad2deg:function(b,c){return a.alg.number(b,c)*(180/Math.PI)},deg2rad:function(b,c){return a.alg.number(b,c)*(Math.PI/180)},sliceArray:function(a,b){var c=a;try{c=window.Array.prototype.slice.call(a||[],b||0)}catch(h){c=
[]}return c},sortArrayObj:function(b,c,d){var h=a.alg.sliceArray(arguments,2);a.alg.array(b).sort(a.alg.__sortArrayObj(c,h));return b},__sortArrayObj:function(b,c){var d;switch(a.env.browser.name){case "IE":case "Edge":d=function(a,d){for(var n=0;a&&d&&n<c.length;n++)a=a[c[n]],d=d[c[n]];var n=b?a:d,f=b?d:a;return n>f?1:n<f?-1:0};break;default:d=function(a,d){for(var n=0;a&&d&&n<c.length;n++)a=a[c[n]],d=d[c[n]];return b?a>=d:a<=d}}return d},sortArrayNum:function(b,c){a.alg.array(b).sort(function(b,
h){return c?a.alg.number(b)-a.alg.number(h):a.alg.number(h)-a.alg.number(b)});return b},joinArray:function(b,c){var d,h,v;for(d=1;d<arguments.length;d++)for(c=a.alg.sliceArray(arguments[d]),v=0;v<c.length;v+=8192)h=c.slice(v,v+8192),Array.prototype.push.apply(b,h);return b},bindFn:function(b,c,d){d=d&&d.length?a.alg.sliceArray(d):d?[d]:[];return function(){var h=null;"function"===typeof c&&(h=c.apply(b,d.concat(a.alg.sliceArray(arguments))));return h}},mergeObj:function(b){function c(a,h,b,d){b.hasOwnProperty(h)&&
(d[h]=a)}var d=b,h=a.alg.sliceArray(arguments,1);a.alg.each(h,function(h,b,d,f){h&&f&&a.alg.each(h,c,f)},d);return b},cloneObj:function(b){return b&&"object"===typeof b?a.alg.mergeObj(b.constructor(),b):b},deepCloneObj:function(b){if(!b||"object"!==typeof b)return b;b=this.cloneObj(b);a.alg.each(b,function(b,c,h){h[c]=a.alg.deepCloneObj(b)});return b},keycodes:{KC_Backspace:8,KC_Tab:9,KC_Enter:13,KC_Shift:16,KC_Ctrl:17,KC_Alt:18,KC_Pause:19,KC_Break:19,KC_CapsLock:20,KC_Escape:27,KC_Space:32,KC_PageUp:33,
KC_PageDown:34,KC_End:35,KC_Home:36,KC_LeftArrow:37,KC_UpArrow:38,KC_RightArrow:39,KC_DownArrow:40,KC_Insert:45,KC_Delete:46,KC_0:48,KC_1:49,KC_2:50,KC_3:51,KC_4:52,KC_5:53,KC_6:54,KC_7:55,KC_8:56,KC_9:57,KC_A:65,KC_B:66,KC_C:67,KC_D:68,KC_E:69,KC_F:70,KC_G:71,KC_H:72,KC_I:73,KC_J:74,KC_K:75,KC_L:76,KC_M:77,KC_N:78,KC_O:79,KC_P:80,KC_Q:81,KC_R:82,KC_S:83,KC_T:84,KC_U:85,KC_V:86,KC_W:87,KC_X:88,KC_Y:89,KC_Z:90,KC_LWin:91,KC_RWin:92,KC_Select:93,KC_Num0:96,KC_Num1:97,KC_Num2:98,KC_Num3:99,KC_Num4:100,
KC_Num5:101,KC_Num6:102,KC_Num7:103,KC_Num8:104,KC_Num9:105,KC_NumAsterisk:106,KC_NumPlus:107,KC_NumMinus:109,KC_NumPeriod:110,KC_NumSlash:111,KC_F1:112,KC_F2:113,KC_F3:114,KC_F4:115,KC_F5:116,KC_F6:117,KC_F7:118,KC_F8:119,KC_F9:120,KC_F10:121,KC_F11:122,KC_F12:123,KC_NumLock:144,KC_ScrollLock:145,KC_SemiColon:186,KC_Equal:187,KC_Comma:188,KC_Dash:189,KC_Period:190,KC_FSlash:191,KC_BSlash:220,KC_Grave:192,KC_LBracket:219,KC_RBracket:221,KC_Apos:222},min:function(b,c){var d=b;a.alg.each(arguments,
function(a){d="undefined"===typeof d?a:d;d=d>a?a:d});return d},max:function(b,c){var d=b;a.alg.each(arguments,function(a){d="undefined"===typeof d?a:d;d=d<a?a:d});return d},property:function(a){for(var b=1;b<arguments.length;++b)if("undefined"!==typeof a[arguments[b]])return a[arguments[b]]}};a&&Object.defineProperty(a,"alg",{value:b});return b}function g(a){function b(a,c,n){var f=a=a||[];b.fn.isPrototypeOf(a)||("string"===typeof f&&(a=-1===(f.match(/(^\\\<|\<)/g)||[]).indexOf("<")?t.querySelectorAll(f):
e(f)),d(a)&&(a=[a]),a=Array.prototype.slice.call(a,0),a=Object.create(b.fn,{_element:{value:a}}),a.each(function(a){a.__jspyder||(a.__jspyder=k())}));a.use(c,n);return a}function d(b){return a.alg.bool("object"===typeof HTMLElement&&b instanceof HTMLElement||b&&"object"===typeof b&&1===b.nodeType&&"string"===typeof b.nodeName)}function f(a){return d(a)?a.className.replace(/(^\s+)|(\s(?=\s))|(\s+$)/g,"").split(" "):[]}function e(a){var b=t.createElement("div"),c=[];b.innerHTML=a;for(a=0;a<b.children.length;a++)c.push(b.children[a]);
return c}if(a.dom)return a.dom;b.fn={_element:[],get count(){return this._element.length},each:function(b,c){a.alg.arrEach(this._element,b,c);return this},use:function(b,c){a.alg.use(this,b,c);return this},setCss:function(h,c){if(h&&"object"===typeof h){var d=a.alg.each;this.each(function(a,h,f,e){d(e,function(a,b,h,c){c.style[b]=a},a);"function"===typeof c&&b(a,c,[e])},h)}return this},getCss:function(h,c){if(h&&"object"===typeof h){var d=Object.create(h),f=a.alg.each;this.each(function(a,h,d,n){d=
getComputedStyle(a);var e=a.style;n=+h?n.others:n.first;f(n,function(a,b,h,c){h[b]=c.style[b]||c.cStyle[b]},{style:e,cStyle:d});"function"===typeof c&&b(a,c,[n])},{first:h,others:d})}return this},exportCss:function(a){a=a||{};this.getCss(a);return a},getPosition:function(a){this.each(function(c){var d=c.getBoundingClientRect();b(c).use(a,[d])});return this},exportPosition:function(){var a=null;this.at(0).use(function(){a=this._element[0].getBoundingClientRect()});return a},getOffsetPosition:function(h){this.each(function(c){for(var d=
c.parentNode,f={top:0,left:0,bottom:0,right:0,x:0,y:0,height:0,width:0};d&&!/absolute|fixed|relative/i.test(getComputedStyle(d).position);)d=d.parentNode;var e=c.getBoundingClientRect(),g=(d||t.body).getBoundingClientRect();a.alg.each(f,function(a,b,h){h[b]=e[b]-g[b]});b(d).use(h,[f])});return this},exportOffsetPosition:function(){var a=null;this.getOffsetPosition(function(b){a||(a=b)});return a},getAttrs:function(h,c){if(h&&"object"===typeof h){var d=Object.create(h),f=a.alg.each;this.each(function(h,
d,n,e){e=d?e.others:e.first;f(e,function(b,c,d){switch(typeof d[c]){case "number":d[c]=a.alg.number(h.getAttribute(c),b);break;case "string":d[c]=a.alg.string(h.getAttribute(c),b);break;case "boolean":d[c]=a.alg.bool(h.getAttribute(c),b);default:d[c]=h.getAttribute(c)}});"function"===typeof c&&b(h,c,[e])},{first:h,others:d})}return this},exportAttrs:function(a){a=a||{};this.getAttrs(a);return a},setAttrs:function(h,c){if(h&&"object"===typeof h){var d=Object.create(h),f=a.alg.each;this.each(function(a,
h,d,n){n=+h?n.others:n.first;f(n,function(a,b,h,c){null===a||"undefined"===typeof a?c.removeAttribute(b):c.setAttribute(b,a)},a);"function"===typeof c&&b(a,c,[n])},{first:h,others:d})}return this},exportAttr:function(b){b=a.alg.string(b);var c={};c[b]=null;return this.exportAttrs(c)[b]},getAttr:function(b,c){b=a.alg.string(b);var d={};d[b]=null;return this.getAttrs(d)},setAttr:function(b,c,d){b=a.alg.string(b);var f={};f[b]=c;return this.setAttrs(f,d)},parents:function(a){this.each(function(c,d,f){b(c.parentNode,
a,[c])});return this},children:function(a,c){this.each(function(d,f,e){for(d=d.firstElementChild;d;)b(d,a,[d,c]),d=d.nextElementSibling});return this},at:function(h,c){h=a.alg.uint(h);return b(this._element[h]||null,c)},element:function(a,b){this.at(a,function(){var a=this._element[0];a&&"function"===typeof b&&b.apply(a,[this])});return this},exportElement:function(a){var b=null;this.element(a,function(){b=this});return b},attach:function(a,c){var d=this;b(a).element(0,function(a){var h=t.createDocumentFragment();
d.each(b.fn._append,h);this.appendChild(h);a.use(c,d)});return this},attachStart:function(a,c){var d=this;b(a).element(0,function(a){var h=t.createDocumentFragment(),f=this.parentNode,e=a._element[0];d.each(b.fn._append,h);f&&f.insertBefore(h,e&&e!==d._element[0]?e:f.children[0]);a.use(c,d)});return this},attachEnd:function(a,c){var d=this;b(a).element(0,function(a){var h=t.createDocumentFragment();d.each(b.fn._append,h);this.parentNode&&this.parentNode.insertBefore(h,this.nextSibling);a.use(c,d)});
return this},append:function(a){this.element(0,function(){var c=t.createDocumentFragment();b(a).each(b.fn._append,c);this.appendChild(c)});return this},_append:function(a,b,c,d){d.appendChild(a)},appendBefore:function(a){this.element(0,function(){var c=t.createDocumentFragment();b(a).each(b.fn._append,c);this.parentNode&&this.parentNode.insertBefore(c,this)});return this},appendAfter:function(a){this.element(0,function(){var c=t.createDocumentFragment();b(a).each(b.fn._append,c);this.parentNode&&
this.parentNode.insertBefore(c,this.nextSibling)});return this},prepend:function(a){this.element(0,function(){var c=t.createDocumentFragment();b(a).each(function(a,b,h,c){c.appendChild(a)},c);this.insertBefore(c,this.firstChild)});return this},remove:function(){this.each(function(a){a.parentNode&&a.parentNode.removeChild(a)});return this},setClasses:function(b){this.each(function(b,h,c,d){a.alg.each(d,function(a,b,h,c){"toggle"===a&&(a=-1===f(c).indexOf(b));h=f(c);var d=h.indexOf(b),e=!1;a&&-1===
d?(h.push(b),e=!0):a||-1===d||(h.splice(d,1),e=!0);e&&(c.className=h.join(" "))},b)},b);return this},getClasses:function(h,c){this.each(function(h,d,e,g){g=a.alg.number(d)?g.second:g.first;a.alg.each(g,function(a,b,h,c){a=c.classes;c=-1!==f(c.el).indexOf(b);a[b]=c},{el:h,classes:g});b(h,c,[g])},{first:h,second:Object.create(h)});return this},exportClasses:function(a){a=a||{};this.getClasses(a);return a},on:function(b,c){b=(b||"").split(/\s+/);a.alg.each(b,function(b,h,d,f){a.alg.each(f._element,function(a){a.addEventListener(b,
c);a.__jspyder.fetch("js-events-"+b)?a.__jspyder.fetch("js-events-"+b).push(c):a.__jspyder.stash("js-events-"+b,[c])})},this);return this},off:function(b,c){b=(b||"").split(/\s+/);var d=this;a.alg.each(b,function(b){a.alg.each(d._element,function(a){var h=a.__jspyder.fetch("js-events-"+b),d=-1;a.removeEventListener(b,c);if(h){for(;0<=(d=h.indexOf(c));)h[d]=null;h.sort().splice(0,h.indexOf(null))}})})},trigger:function(a){a=(a||"").toString().split(/\s+/);for(var b,c=0;c<a.length;c++)a[c]&&(b=this._eventConstructor(a[c],
!0,!0),this.each(function(a){a.dispatchEvent(b)}));return this},_eventConstructor:function(a,c,d){b.fn._eventConstructor="function"===typeof window.Event?function(a,b,c){return new Event(a,{bubbles:b,cancelable:c})}:function(a,b,c){var h=window.document.createEvent("Event");h.initEvent(a,b,c);return h};return b.fn._eventConstructor.apply(this,arguments)},setHtml:function(a){this.each(function(b){b.innerHTML=a||""});return this},getHtml:function(a){"function"===typeof a&&this.each(function(b){a.call(b,
b.innerHTML||"")});return this},exportHtml:function(){var a=null;this.getHtml(function(b){a||(a=b)});return a},getText:function(b){if("function"===typeof b){var c="undefined"===typeof t.documentElement.textContent?"innerText":"textContent";this.each(function(d){b.call(d,a.alg.string(d[c]))})}return this},exportText:function(){var a=null;this.getText(function(b){a||(a=b)});return a},setText:function(b){var c="undefined"===typeof t.documentElement.textContent?"innerText":"textContent";b=a.alg.string(b);
this.each(function(a){a[c]=b});return this},find:function(c){var d=b(),f=d._element;this.each(function(d){c&&(d=d.querySelectorAll(c),a.alg.joinArray(f,b(d)._element))});return d},filter:function(a){var c=b(),d=c._element;this.each(function(c){b.fn._matches(c,a)&&d.push(c)});return c},exclude:function(a){var c=b(),d=c._element;this.each(function(c){b.fn._matches(c,a)||d.push(c)});return c},_matches:function(a,c){var d="";a.matches?d="matches":a.matchesSelector?d="matchesSelector":a.msMatchesSelector?
d="msMatchesSelector":a.mozMatchesSelector?d="mozMatchesSelector":a.webkitMatchesSelector?d="webkitMatchesSelector":a.oMatchesSelector?d="oMatchesSelector":b.fn._matches=function(a,b){for(var c=(a.document||a.ownerDocument).querySelectorAll(b),d=c.length;0<=--d&&c.item(d)!==a;);return-1<d};b.fn._matches=function(a,b){return d&&a[d](b)};return this._matches(a,c)},and:function(a){b(a,this._and,[this._element]);return this},_and:function(b){a.alg.joinArray(b,this._element)},template:function(a){this.each(this._template,
{self:this,fields:a});return this},_template:function(a,b,c,d){d.self._template_parse(a,d.fields)},_template_parse:function(a,b){var c=Object.keys(b),d,f,e;for(d=0;d<c.length;d++)f=c[d],e=b[f],this._template_insert(a,"${"+f+"}",e);return a},_template_insert:function(a,b,c){a=a.childNodes;var d,f;for(f=0;f<a.length;f++)d=a[f],3===d.nodeType?this._template_replace(d,b,c):this._template_insert(d,b,c);return!0},_template_replace:function(a,c,d){var f=a.data.indexOf(c),e=a.parentNode,g;if(-1===f)return!1;
g=a.splitText(f);g.data=g.data.substr(c.length);b(d).each(function(a){e.insertBefore(a,g)});return!0},setValue:function(a,b){return this.each(function(b){"undefined"!==typeof b.value&&"LI"!==b.tagName?b.value=a:b.setAttribute("value",a)}).use(b)},getValue:function(a){var b=this;return b.each(function(c){var d="undefined"!==typeof c.value?c.value:c.getAttribute("value");"LI"===c.tagName&&(d=c.getAttribute("value"));"undefined"!==d&&b.use(a,[d])})},exportValue:function(){var a=null;this.getValue(function(b){a=
b});return a},getProps:function(b,c){this.each(function(c){a.alg.each(b,function(a,b,d){d[b]=c[b]})});this.use(c,[b]);return this},exportProps:function(a){a=a||{};this.getProps(a);return a},setProps:function(b){this.each(function(c){a.alg.each(b,function(a,b){c[b]=a})});return this},setDraggable:function(b){this.find(b).exclude(".js-draggable").setClasses({"js-draggable":!0}).on("mousedown",function(b){!c&&a.dom(b.target).exportClasses({"js-drag-handle":null})["js-drag-handle"]&&(c=a.dom(this),c.setClasses({active:!0,
"js-draggable-placeholder":!0}),c.parents(function(a){d.push(a.parentElement)}),f=b.clientY)});var c=null,d=[],f=0;a.dom.doc.on("mouseup",function(a){c&&(c.setClasses({active:!1,"js-draggable-placeholder":!1}),c=null,d.length=0)}).on("mousemove",function(b){if(c){var h=b.clientY,e=f>h;f=h;var g=a.dom(b.target);for(b=g.exportClasses({"js-draggable":null,"js-draggable-placeholder":null});g.count&&!b["js-draggable"];)g.parents(function(){g=this}),b=g.exportClasses({"js-draggable":null,"js-draggable-placeholder":null});
b["js-draggable-placeholder"]||g.parents(function(a){if(-1!==d.indexOf(a.parentElement))c[e?"attachStart":"attachEnd"](g)})}});return this},inlineStyles:function(){function b(f){a.alg.arrEach(c.document.styleSheets,d,f);a.alg.arrEach(f.children,b)}function d(b,c,h,e){b=a.alg.property(b,"rules","cssRules");a.alg.arrEach(b,f,e)}function f(b,c,d,h){if(a.alg.use(h,h.matches,[b.selectorText]))try{var e=h.getAttribute("style");h.setAttribute("style",b.cssText.match(/{(.*)}$/)[1]+";"+e)}catch(n){a.log.err(n)}}
return function(){return this.each(b)}}()};b.doc=b(t.documentElement);a&&Object.defineProperty(a,"dom",{value:b});return b}function q(a){function b(d,f,h){d=c.fetch(d);var e=null;d&&"function"===typeof d&&(e=d.apply(a,f));"function"===typeof h&&h.call(this,e);return this}var c=k();b.register=function(a,b){"string"==typeof a&&("function"!==typeof b&&null!==b||c.stash(a,b));return this};b.registerSet=function(c){c&&"object"===typeof c&&a.alg.each(c,function(a,c){b.register(c,a)});return this};b.execute=
function(a,c){var d;b(a,c,function(a){d=a});return d};a.extend("lib",b)}function k(){var a={};return{fetch:function(b,c){var d={key:b,value:a[b]};"function"===typeof c&&c(d);return d.value},stash:function(b,c){return a[b]=c}}}var m=c.jspyder,t=c.document||window.document;m||(m=b(c));c[d]||(c[d]=m);return m})(window,"js");jspyder.extend.fn("ajax",function(){function c(a,b,d){var g=Object.create(c.fn);g.data="object"===typeof b&&b?b:{};g.url="string"===typeof a?a:g.url;g.fn="function"===typeof d?d:g.fn;"function"===typeof d&&d.apply(g);return g}function d(a,c,d,g,q){if(!c)return this;var k=new XMLHttpRequest;k.onreadystatechange=function(){4===this.readyState&&"function"===typeof g&&b.alg.use(b,g,[this,q]);return null};k.open(a,c,!0);d||(d={});d.contentType&&k.setRequestHeader("Content-Type",d.contentType);d.cache||
k.setRequestHeader("Cache-Control","no-cache");k.send();return this}var b=this;c.fn={data:{},url:"",fn:function(){},get:function(a,b){a="function"===typeof a?a:this.fn;d("GET",this.url,this.data,a,b);return this},head:function(a,b){a="function"===typeof a?a:this.fn;d("HEAD",this.url,this.data,a,b);return this},post:function(a,b){a="function"===typeof a?a:this.fn;d("POST",this.url,this.data,a,b);return this}};return c});jspyder.extend.fn("canvas",function(){function c(a){a=a||{};var d=b.dom(a.canvas||"<canvas></canvas>"),e=a.css,g={height:b.alg.number(a.height,150),width:b.alg.number(a.width,300)};a.canvas||d.setCss(e).setAttrs(g);return Object.create(c.fn,{canvas:{value:d},queue:{value:[]},context:{value:d._element[0]&&d._element[0].getContext&&d._element[0].getContext("2d")}})}function d(a){a=a||{};a.fill=b.alg.string(a.fill,"#FFF");a.border=b.alg.string(a.border,"transparent");a.borderWidth=b.alg.number(a.borderWidth,
0);a.borderTopWidth=b.alg.number(a.borderTopWidth,a.borderWidth);a.borderRightWidth=b.alg.number(a.borderRightWidth,a.borderWidth);a.borderBottomWidth=b.alg.number(a.borderBottomWidth,a.borderWidth);a.borderLeftWidth=b.alg.number(a.borderLeftWidth,a.borderWidth);a.x=b.alg.number(a.x,0);a.y=b.alg.number(a.y,0);a.height=b.alg.number(a.height,0);a.width=b.alg.number(a.width,0);return a}var b=this;c.fn={canvas:null,context:null,queue:null,attach:function(){this.canvas&&this.canvas.attach(arguments);return this},
remove:function(){this.canvas&&this.canvas.remove();return this},getSize:function(a){b.alg.use(this,a,[this.exportSize()]);return this},exportSize:function(){var a={height:0,width:0,x:0,y:0},b=this.canvas&&this.canvas._element&&this.canvas._element[0],c;b&&(c=b.getBoundingClientRect(),a.width=b.width,a.height=b.height,a.x=c.x,a.y=c.y);return a},exportImageUrl:function(a){var b="";this.canvas&&this.canvas.element(0,function(){b=this.toDataURL("image/"+a)});return b},getImageUrl:function(a,c){b.alg.use(this,
c,[this.exportImageUrl(a)]);return this},exportImage:function(a){return b.dom("<img></img>").setAttrs({src:this.exportImageUrl(a)})},getImage:function(a,c){b.alg.use(this,c,[this.exportImage(a)]);return this},clear:function(){var a=this;this.getSize(function(b){a.context.clearRect(0,0,b.width,b.height)});return this},render:function(){this.clear();if(this.context){var a=this;b.alg.each(this.queue,function(c){b.alg.use(a,c)})}return this},draw:function(a,c){var d=this.cmd[a],g;d&&(g=function(){b.alg.use(this,
d,[c])},"function"===typeof g&&(g.settings=c,g.type=a,this.queue&&this.queue.push(g)));return this},cmd:{rectangle:function(a){a=d(a);this.context.fillStyle=a.border;this.context.fillRect(a.x,a.y,a.width,a.height);this.context.fillStyle=a.fill;this.context.fillRect(a.x+a.borderLeftWidth,a.y+a.borderTopWidth,a.width-(a.borderRightWidth+a.borderLeftWidth),a.height-(a.borderBottomWidth+a.borderTopWidth))},arc:function(a){a=d(a);a.radius=b.alg.number(a.radius,0);a.anticlockwise=b.alg.bool(a.anticlockwise,
!1);var c=b.alg.deg2rad(a.angle,0),e=b.alg.deg2rad(a.degrees,360)+c;this.context.beginPath();this.context.arc(a.x,a.y,a.radius,c,e,a.anticlockwise);a.fromcenter&&this.context.lineTo(a.x,a.y);a.closepath&&this.context.closePath();this.context.strokeStyle=a.border;this.context.stroke();this.context.fillStyle=a.fill;this.context.fill()},circle:function(a){a=d(a);a.degrees=360;b.alg.use(this,this.cmd.arc,[a])},text:function(a){a=a||{};a.size=b.alg.number(a.size,16);a.font=b.alg.string(a.font,"Arial");
a.text=b.alg.string(a.text,"");a.x=b.alg.string(a.x,0);a.y=b.alg.string(a.y,0);a.outline=b.alg.string(a.outline,"transparent");a.fill=b.alg.string(a.fill,"black");a.textalign=b.alg.string(a.textalign,"start");this.context.textAlign=a.textalign;this.context.font=a.size+"px "+a.font;this.context.fillStyle=a.fill;this.context.fillText(a.text,a.x,a.y);this.context.strokeStyle=a.outline;this.context.strokeText(a.text,a.x,a.y)},line:function(a){a=a||{};a.x=b.alg.number(a.x,0);a.y=b.alg.number(a.y,0);a.width=
b.alg.number(a.width,0);a.height=b.alg.number(a.height,0);a.color=b.alg.string(a.color,"black");a.thickness=b.alg.number(a.thickness,1);this.context.strokeStyle=a.color;this.context.lineWidth=a.thickness;this.context.beginPath();this.context.moveTo(a.x,a.y);this.context.lineTo(a.x+a.width,a.y+a.height);this.context.stroke()},pie:function(a){a=d(a);a.radius=b.alg.number(a.radius,0);a.angle=b.alg.number(a.angle,-90);a.anticlockwise=b.alg.bool(a.anticlockwise,!1);a.closepath=!0;a.degrees=360;var c=this,
e=0,g=0;b.alg.use(c,c.cmd.arc,[a]);b.alg.each(a.sections,function(a){e+=b.alg.number(a.value,0)});b.alg.each(a.sections,function(d){var k=b.alg.number(d.value,0)/e*360;d=b.alg.mergeObj({},a,{angle:g+a.angle,degrees:k,fill:d.fill,fromcenter:!0,closepath:!0});g+=k;b.alg.use(c,c.cmd.arc,[d])})},barchart:function(a){a=a||{};var c=a.sections=a.sections||[],d=this.exportSize(),g=a.borderWidth=b.alg.number(a.borderWidth,1),q=a.width=b.alg.number(a.width,d.width),k=a.height=b.alg.number(a.height,d.height),
m=a.x=b.alg.number(a.x,0),d=a.y=b.alg.number(a.y,0),t=a.fill=b.alg.string(a.fill,"white"),u=a.border=b.alg.string(a.border,"black"),r=a.lineColor=b.alg.string(a.lineColor,"rgba(0, 0, 0, 0.3)"),w=a.labels=a.labels||[],l=a.labelSize=b.alg.number(a.labelSize,16),p=a.min=b.alg.number(a.min,Infinity),h=a.max=b.alg.number(a.max,-Infinity),v=b.alg.bindFn(this,a.format||function(a){return a}),n=this,y,x;a=1.5*l;n.cmd.rectangle.call(this,{width:q,height:k,x:m,y:d,fill:t,borderWidth:g,border:u});q-=2*g;k-=
2*g;m+=g;d+=g;k-=a;b.alg.arrEach(c,function(a){var c=-1;b.alg.arrEach(a.values,function(a){c++;p=b.alg.min(p,a);h=b.alg.max(h,a)});y=b.alg.max(++c,y)});h=1.1*b.alg.magnitude(h);b.alg.iterate(0,5,function(a){n.cmd.line.call(n,{x:m,y:k*(5-a)/5,width:q+m,height:0,color:r});n.cmd.text.call(n,{x:l/3,y:k*(5-a)/5-l/3,size:l,font:"Arial",text:v(a/5*h|0),textalign:"left"});n.cmd.text.call(n,{x:q-l/3,y:k*(5-a)/5-l/3,size:l,font:"Arial",text:v(a/5*h|0),textalign:"right"})});q-=50;m+=50;x=q/((c.length+1)*y);
var z={x:m,y:d,height:k-d,width:q-m,vertWidth:(q-m)/y};b.alg.iterate(0,y+1,function(a){n.cmd.line.call(n,{x:z.x+z.vertWidth*a,y:z.y,width:0,height:z.height,color:r});n.cmd.text.call(n,{text:w[a],font:"Arial",size:l,x:z.x+z.vertWidth*(a+a+1)/2,y:z.height+l,textalign:"center"})});b.alg.arrEach(c,function(a,d){var e=a.fill=b.alg.string(a.fill,"black"),g=a.border=b.alg.string(a.border,e),v=a.borderWidth=b.alg.number(a.borderWidth,1);b.alg.arrEach(a&&a.values,function(a,m){var y=k*(b.alg.number(a)/(h||
1));n.cmd.rectangle.call(n,{x:z.x+(x/c.length+d*x+m*z.vertWidth),y:z.y+(z.height-z.y-y),width:x,height:y,fill:e,border:g,borderWidth:v})})})},linechart:function(a){a=a||{};var c=a.sections=a.sections||[],d=this.exportSize(),g=a.borderWidth=b.alg.number(a.borderWidth,1),q=a.width=b.alg.number(a.width,d.width),k=a.height=b.alg.number(a.height,d.height),m=a.x=b.alg.number(a.x,0),d=a.y=b.alg.number(a.y,0),t=a.fill=b.alg.string(a.fill,"white"),u=a.border=b.alg.string(a.border,"black"),r=a.labels=a.labels||
[],w=a.labelSize=b.alg.number(a.labelSize,16),l=a.linecolor=b.alg.string(a.linecolor,"rgba(0, 0, 0, 0.3)"),p=b.alg.number(a.min,Infinity),h=b.alg.number(a.max,-Infinity),v=b.alg.bindFn(this,a.format||function(a){return a|0}),n=this,y;a=1.5*w;n.cmd.rectangle.call(this,{width:q,height:k,x:m,y:d,fill:t,borderWidth:g,border:u});q-=2*g;k-=2*g;m+=g;d+=g;k-=a;b.alg.arrEach(c,function(a){var c=-1;b.alg.arrEach(a.values,function(a){c++;p=b.alg.min(p,a);h=b.alg.max(h,a)});y=b.alg.max(++c,y)});h=1.1*b.alg.magnitude(h);
b.alg.iterate(0,5,function(a){n.cmd.line.call(n,{x:m,y:k*(5-a)/5,width:q+m,height:0,color:l});n.cmd.text.call(n,{x:w/3,y:k*(5-a)/5-w/3,size:w,font:"Arial",text:v(a/5*h),textalign:"left"});n.cmd.text.call(n,{x:q-w/3,y:k*(5-a)/5-w/3,size:w,font:"Arial",text:v(a/5*h),textalign:"right"})});var q=q-50,m=m+50,x={x:m,y:d,height:k-d,width:q-m,vertWidth:(q-m)/(y-1)};b.alg.iterate(0,y,function(a){var b=x.x+x.vertWidth*a;n.cmd.line.call(n,{x:b,y:x.y,width:0,height:x.height,color:l});n.cmd.text.call(n,{text:r[a],
font:"Arial",size:w,x:b,y:x.height+w,textalign:"center"})});b.alg.arrEach(c,function(a,c){var d=a.fill=b.alg.string(a.fill,"transparent"),f=a.border=b.alg.string(a.border,"black"),e=a.borderWidth=b.alg.number(a.borderWidth,1),g=a.dotfill=b.alg.string(a.dotfill,d),v=a.dotBorder=b.alg.string(a.dotBorder,f),m=a.dotBorderWidth=b.alg.string(a.dotBorderWidth,e),y=a.dotRadius=b.alg.number(a.dotRadius,4);b.alg.arrEach(a&&a.values,function(a,c,d){d=x.height-(x.y+x.height*b.alg.number(d[c-1])/(h||1));a=x.height-
(x.y+x.height*b.alg.number(a)/(h||1));var q=x.x+x.vertWidth*(c-1),p=x.x+x.vertWidth*c;c&&n.cmd.line.call(n,{x:q,y:d,width:x.vertWidth,height:a-d,color:f,thickness:e});n.cmd.circle.call(n,{y:a,x:p,radius:y,fill:g,border:v,thickness:m});n.cmd.circle.call(n,{y:d,x:q,radius:y,fill:g,border:v,thickness:m})})})}}};return c});jspyder.extend.fn("date",function(){function c(a,b,d){return Object.create(c.fn).setDate(a,b,d)}function d(a,b){var c=[],d=null,f=null,g={},m={};e.alg.arrEach(a,function(a,d){var h=a[b];h&&(c.push(h),g[h]=d,m[d]=h)});c.sort(function(a,b){return b.length-a.length});d="("+c.join("|")+")";f=new RegExp(d,"g");return{string:d,regexp:f,values:g,lookup:m}}function b(a,b){a=e.alg.string(a,"");var c=e.alg.string(b),d={y:0,m:0,d:1,h:0,n:0,s:0,x:0,a:0};e.alg.arrEach(c.match(g),function(b){var c=p[b];if(!c)return b;
var f=c.values,c=(a.match(c.regexp)||[0])[0],n=c.length,g=a.indexOf(c);a=a.substring(g+n);switch(b){case "yy":case "YY":c="20"+c;case "yyyy":case "YYYY":d.y=e.alg.number(c);break;case "MMMM":case "MMM":case "mmmm":case "mmm":c=f[c]+1;case "MM":case "mm":case "M":case "m":d.m=e.alg.number(c)-1;break;case "ddth":case "dth":c=c.substr(0,c.length-2);case "dd":case "d":d.d=e.alg.number(c)||1;break;case "hh":case "h":case "HH":case "H":d.h=e.alg.number(c,0);break;case "am":case "AM":d.a="pm"===c||"PM"===
c?12:0;break;case "nn":case "n":d.n=e.alg.number(c,0);break;case "ss":case "s":d.s=e.alg.number(c,0);break;case "xxx":d.x=e.alg.number(c,0);break;case "xx":d.x=10*e.alg.number(c,0);break;case "x":d.x=100*e.alg.number(c,0)}});return new Date(d.y,d.m,d.d,d.h+d.a,d.n,d.s,d.x)}function a(a,b,c){var d=c?a.getUTCFullYear():a.getFullYear(),f=c?a.getUTCMonth():a.getMonth(),m=c?a.getUTCDate():a.getDate(),q=c?a.getUTCHours():a.getHours(),k=c?a.getUTCMinutes():a.getMinutes(),l=c?a.getUTCSeconds():a.getSeconds(),
u=c?a.getUTCDay():a.getDay(),t=c?a.getUTCMilliseconds():a.getMilliseconds(),r="",w=b;e.alg.arrEach(b.match(g),function(a){var b=p[a]||/\[[^\\]*\]/g.test(a);if(!b)return a;var c=a.length,h=w.indexOf(a),n="";r+=w.substring(0,h);w=w.substring(h+c);switch(a){case "YY":case "yy":n=e.alg.string(d%100);break;case "YYYY":case "yyyy":n=e.alg.string(d,"");break;case "MMMM":case "mmmm":case "MMM":case "mmm":case "MM":case "mm":case "M":case "m":n=b.lookup[f];break;case "dth":case "ddth":case "dd":case "d":n=
b.lookup[m-1];break;case "DDDD":case "dddd":case "DDD":case "ddd":case "DD":case "D":n=b.lookup[u];break;case "am":case "AM":n=b.lookup[q];break;case "HH":case "H":case "hh":case "h":n=b.lookup[q];break;case "nn":case "n":n=b.lookup[k];break;case "ss":case "s":n=b.lookup[l];break;case "xxx":n=(e.alg.string(t)+"00").substr(0,3);break;case "xx":n=(e.alg.string(t)+"0").substr(0,2);break;case "x":n=e.alg.string(t).substr(0,1);break;default:n=a.substring(1,a.length-1)}r+=e.alg.string(n,"")});return r+
w}function f(a,b,c,d){var f=d-(d|0),e=null,g=e=0;a[b](d);f&&(g=a.getTime(),e=new Date(g),e[b](e[c]()+1),e=(e.getTime()-g)*f,a.setTime(g+e));return a}var e=this;c.fn=c.prototype={_value:null,_format:"",_useUTC:!1,clone:function(){return c(new Date(this._value),this._format,this._useUTC)},utcOffset:function(){return this._value.getTimezoneOffset()},isDst:function(){var a=this.utcOffset(),b=this.clone();return a>b.setMonth(1).utcOffset()||a>b.setMonth(6).utcOffset()},useUTC:function(a){this._useUTC=
e.alg.bool(a,!0);return this},isUTC:function(){return this._useUTC},useLocal:function(a){this._useUTC=!e.alg.bool(a,!0);return this},setDate:function(a,d,f){this._value="undefined"===typeof a?new Date:c.fn.isPrototypeOf(a)?a._value:a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)?new Date(a):"string"===typeof a?b(a,d):"number"===typeof a?new Date(a):new Date(NaN);this._format=e.alg.string(d,"");this._useUTC=e.alg.bool(f,!1);return this},asDate:function(){return this._value},
asString:function(b,c,d){return this.isValid()?(b=e.alg.string(b,this._format||q),c=e.alg.bool(c,this._useUTC),a(this._value,b,c)):e.alg.string(d,"")},toString:function(){return Date.prototype.toString.apply(this._value,arguments)},getTime:function(a,b,c,d,f,g,m){var q=this._value;a=e.alg.bool(a,!0)*q.getFullYear();b=e.alg.bool(b,!0)*q.getMonth();c=e.alg.bool(c,!0)*q.getDate();d=e.alg.bool(d,!0)*q.getHours();f=e.alg.bool(f,!0)*q.getMinutes();g=e.alg.bool(g,!0)*q.getSeconds();m=e.alg.bool(m,!0)*q.getMilliseconds();
return Date.prototype.getTime.call(new Date(a,b,c,d,f,g,m))},isValid:function(){return this._value&&!isNaN(this._value.getYear())},addDays:function(a){var b=this._value.getDate();a=e.alg.number(a);f(this._value,"setDate","getDate",b+a);return this},setDay:function(a){a=e.alg.number(a);f(this._value,"setDate","getDate",a);return this},getDay:function(a){e.alg.use(this,a,[this.exportDay()]);return this},exportDay:function(){return this._value.getDate()},exportDayList:function(a){a=e.alg.string(a,"d");
for(var b=this.exportDayCount(),c=this.clone(),d=1,f=[];d<=b;)c.setDay(d),f.push(c.asString(a)),d++;return f},getDayList:function(a,b){e.alg.use(this,b,[this.exportDayList(a)]);return this},exportDayCount:function(){return e.alg.number(this.clone().addMonths(1).setDay(0).asString("d"))},getDayCount:function(a){e.alg.use(this,a,[this.exportDayCount()]);return this},exportWeekdayList:function(a){a=e.alg.string(a,"dddd");for(var b=this.exportWeekdayCount(),c=0,d=null,f=[];c<b;)d=u[c],f.push("undefined"===
typeof d[a]?a:d[a]),c++;return f},getWeekdayList:function(a,b){e.alg.use(this,b,[this.exportWeekdayList(a)]);return this},exportWeekdayCount:function(){return e.alg.number(u.length,0)},getWeekdayCount:function(a){e.alg.use(this,a,[this.exportWeekdayCount()]);return this},exportWeekdayOffset:function(){var a={str:this.clone().setDay(1).asString("dddd"),found:0};e.alg.arrEach(this.exportWeekdayList("dddd"),this._getWeekdayOffset,a);return e.alg.number(a.found,0)},_getWeekdayOffset:function(a,b,c,d){a===
d.str&&(d.found=b,this.stop())},getWeekdayOffset:function(a){e.alg.use(this,a,[this.exportWeekdayOffset()]);return this},addMonths:function(a){var b=this._value.getMonth();a=e.alg.number(a);f(this._value,"setMonth","getMonth",b+a);return this},setMonth:function(a){a=e.alg.number(a)-1;f(this._value,"setMonth","getMonth",a);return this},exportMonth:function(){return this._value.getMonth()+1},getMonth:function(a){e.alg.use(this,a,[this.exportMonth()]);return this},exportMonthList:function(a){a={a:[],
f:e.alg.string(a,"mmmm"),c:this.clone()};e.alg.arrEach(m,this._getMonthList_each,a);return a.a},_getMonthList_each:function(a,b,c,d){d.c.setMonth(b+1);d.a.push(d.c.asString(d.f))},getMonthList:function(a,b){e.alg.use(this,b,[this.exportMonthList(a)]);return this},exportMonthCount:function(){return m.length},getMonthCount:function(a){e.alg.use(this,a,[this.exportMonthCount()]);return this},addYears:function(a){var b=this._value.getFullYear();a=e.alg.number(a);f(this._value,"setFullYear","getFullYear",
b+a);return this},setYear:function(a){a=e.alg.number(a);f(this._value,"setFullYear","getFullYear",a);return this},exportYear:function(){return this._value.getFullYear()},getYear:function(a){e.alg.use(this,a,[this.exportYear()]);return this},addSeconds:function(a){var b=this._value.getSeconds();a=e.alg.number(a);f(this._value,"setSeconds","getSeconds",b+a);return this},setSeconds:function(a){a=e.alg.number(a);f(this._value,"setSeconds","getSeconds",a);return this},exportSecond:function(){return this._value.getSecond()},
getSecond:function(a){e.alg.use(this,a,[this.exportSecond()]);return this},addMinutes:function(a){var b=this._value.getMinutes();a=e.alg.number(a);f(this._value,"setMinutes","getMinutes",b+a);return this},setMinute:function(a){a=e.alg.number(a);f(this._value,"setMinutes","getMinutes",a);return this},exportMinute:function(){return this._value.getMinutes()},getMinute:function(a){e.alg.use(this,a,[this.exportMinute()])},addHours:function(a){var b=this._value.getHours();a=e.alg.number(a);f(this._value,
"setHours","getHours",b+a);return this},setHour:function(a){a=e.alg.number(a);f(this._value,"setHours","getHours",a);return this},exportHour:function(){return this._value.getHours()},getHour:function(a){e.alg.use(this,a,[this.exportHour()]);return this}};var g=/(\[[^\]]*\]|YYYY|YY|yyyy|yy|MMMM|MMM|MM|M|mmmm|mmm|mm|m|dddd|ddd|ddth|dth|dd|d|DDDD|DDD|DD|D|AM|am|HH|H|hh|h|nn|n|ss|s|xxx|xx|x)/g,q="ddd mmm d yyyy hh:mm:ss",k=[{YY:"\\d{2}",YYYY:"\\d{4}",yy:"\\d{2}",yyyy:"\\d{4}"}],m=[{m:"1",mm:"01",mmm:"Jan",
mmmm:"January",M:"1",MM:"01",MMM:"JAN",MMMM:"JANUARY"},{m:"2",mm:"02",mmm:"Feb",mmmm:"February",M:"2",MM:"02",MMM:"FEB",MMMM:"FEBRUARY"},{m:"3",mm:"03",mmm:"Mar",mmmm:"March",M:"3",MM:"03",MMM:"MAR",MMMM:"MARCH"},{m:"4",mm:"04",mmm:"Apr",mmmm:"April",M:"4",MM:"04",MMM:"APR",MMMM:"APRIL"},{m:"5",mm:"05",mmm:"May",mmmm:"May",M:"5",MM:"05",MMM:"MAY",MMMM:"MAY"},{m:"6",mm:"06",mmm:"Jun",mmmm:"June",M:"6",MM:"06",MMM:"JUN",MMMM:"JUNE"},{m:"7",mm:"07",mmm:"Jul",mmmm:"July",M:"7",MM:"07",MMM:"JUL",MMMM:"JULY"},
{m:"8",mm:"08",mmm:"Aug",mmmm:"August",M:"8",MM:"08",MMM:"AUG",MMMM:"AUGUST"},{m:"9",mm:"09",mmm:"Sep",mmmm:"September",M:"9",MM:"09",MMM:"SEP",MMMM:"SEPTEMBER"},{m:"10",mm:"10",mmm:"Oct",mmmm:"October",M:"10",MM:"10",MMM:"OCT",MMMM:"OCTOBER"},{m:"11",mm:"11",mmm:"Nov",mmmm:"November",M:"11",MM:"11",MMM:"NOV",MMMM:"NOVEMBER"},{m:"12",mm:"12",mmm:"Dec",mmmm:"December",M:"12",MM:"12",MMM:"DEC",MMMM:"DECEMBER"}],t=[{d:"1",dd:"01",dth:"1st",ddth:"01st"},{d:"2",dd:"02",dth:"2nd",ddth:"02nd"},{d:"3",dd:"03",
dth:"3rd",ddth:"03th"},{d:"4",dd:"04",dth:"4th",ddth:"04th"},{d:"5",dd:"05",dth:"5th",ddth:"05th"},{d:"6",dd:"06",dth:"6th",ddth:"06th"},{d:"7",dd:"07",dth:"7th",ddth:"07th"},{d:"8",dd:"08",dth:"8th",ddth:"08th"},{d:"9",dd:"09",dth:"9th",ddth:"09rd"},{d:"10",dd:"10",dth:"10th",ddth:"10th"},{d:"11",dd:"11",dth:"11th",ddth:"11st"},{d:"12",dd:"12",dth:"12th",ddth:"12th"},{d:"13",dd:"13",dth:"13th",ddth:"13th"},{d:"14",dd:"14",dth:"14th",ddth:"14th"},{d:"15",dd:"15",dth:"15th",ddth:"15th"},{d:"16",dd:"16",
dth:"16th",ddth:"16th"},{d:"17",dd:"17",dth:"17th",ddth:"17th"},{d:"18",dd:"18",dth:"18th",ddth:"18th"},{d:"19",dd:"19",dth:"19th",ddth:"19th"},{d:"20",dd:"20",dth:"20th",ddth:"20th"},{d:"21",dd:"21",dth:"21st",ddth:"21th"},{d:"22",dd:"22",dth:"22nd",ddth:"22nd"},{d:"23",dd:"23",dth:"23rd",ddth:"23th"},{d:"24",dd:"24",dth:"24th",ddth:"24th"},{d:"25",dd:"25",dth:"25th",ddth:"25th"},{d:"26",dd:"26",dth:"26th",ddth:"26th"},{d:"27",dd:"27",dth:"27th",ddth:"27th"},{d:"28",dd:"28",dth:"28th",ddth:"28th"},
{d:"29",dd:"29",dth:"29th",ddth:"29rd"},{d:"30",dd:"30",dth:"30th",ddth:"30th"},{d:"31",dd:"31",dth:"31st",ddth:"31st"}],u=[{D:"S",DD:"Su",DDD:"SUN",DDDD:"SUNDAY",ddd:"Sun",dddd:"Sunday"},{D:"M",DD:"Mo",DDD:"MON",DDDD:"MONDAY",ddd:"Mon",dddd:"Monday"},{D:"T",DD:"Tu",DDD:"TUE",DDDD:"TUESDAY",ddd:"Tue",dddd:"Tuesday"},{D:"W",DD:"We",DDD:"WED",DDDD:"WEDNESDAY",ddd:"Wed",dddd:"Wednesday"},{D:"T",DD:"Th",DDD:"THU",DDDD:"THURSDAY",ddd:"Thu",dddd:"Thursday"},{D:"F",DD:"Fr",DDD:"FRI",DDDD:"FRIDAY",ddd:"Fri",
dddd:"Friday"},{D:"S",DD:"Sa",DDD:"SAT",DDDD:"SATURDAY",ddd:"Sat",dddd:"Saturday"}],r=[{h:"12",hh:"12",H:"0",HH:"00",AM:"AM",am:"am"},{h:"1",hh:"01",H:"1",HH:"01",AM:"AM",am:"am"},{h:"2",hh:"02",H:"2",HH:"02",AM:"AM",am:"am"},{h:"3",hh:"03",H:"3",HH:"03",AM:"AM",am:"am"},{h:"4",hh:"04",H:"4",HH:"04",AM:"AM",am:"am"},{h:"5",hh:"05",H:"5",HH:"05",AM:"AM",am:"am"},{h:"6",hh:"06",H:"6",HH:"06",AM:"AM",am:"am"},{h:"7",hh:"07",H:"7",HH:"07",AM:"AM",am:"am"},{h:"8",hh:"08",H:"8",HH:"08",AM:"AM",am:"am"},
{h:"9",hh:"09",H:"9",HH:"09",AM:"AM",am:"am"},{h:"10",hh:"10",H:"10",HH:"10",AM:"AM",am:"am"},{h:"11",hh:"11",H:"11",HH:"11",AM:"AM",am:"am"},{h:"12",hh:"12",H:"12",HH:"12",AM:"PM",am:"pm"},{h:"1",hh:"01",H:"13",HH:"13",AM:"PM",am:"pm"},{h:"2",hh:"02",H:"14",HH:"14",AM:"PM",am:"pm"},{h:"3",hh:"03",H:"15",HH:"15",AM:"PM",am:"pm"},{h:"4",hh:"04",H:"16",HH:"16",AM:"PM",am:"pm"},{h:"5",hh:"05",H:"17",HH:"17",AM:"PM",am:"pm"},{h:"6",hh:"06",H:"18",HH:"18",AM:"PM",am:"pm"},{h:"7",hh:"07",H:"19",HH:"19",
AM:"PM",am:"pm"},{h:"8",hh:"08",H:"20",HH:"20",AM:"PM",am:"pm"},{h:"9",hh:"09",H:"21",HH:"21",AM:"PM",am:"pm"},{h:"10",hh:"10",H:"22",HH:"22",AM:"PM",am:"pm"},{h:"11",hh:"11",H:"23",HH:"23",AM:"PM",am:"pm"}],w=[{n:"0",nn:"00"},{n:"1",nn:"01"},{n:"2",nn:"02"},{n:"3",nn:"03"},{n:"4",nn:"04"},{n:"5",nn:"05"},{n:"6",nn:"06"},{n:"7",nn:"07"},{n:"8",nn:"08"},{n:"9",nn:"09"},{n:"10",nn:"10"},{n:"11",nn:"11"},{n:"12",nn:"12"},{n:"13",nn:"13"},{n:"14",nn:"14"},{n:"15",nn:"15"},{n:"16",nn:"16"},{n:"17",nn:"17"},
{n:"18",nn:"18"},{n:"19",nn:"19"},{n:"20",nn:"20"},{n:"21",nn:"21"},{n:"22",nn:"22"},{n:"23",nn:"23"},{n:"24",nn:"24"},{n:"25",nn:"25"},{n:"26",nn:"26"},{n:"27",nn:"27"},{n:"28",nn:"28"},{n:"29",nn:"29"},{n:"30",nn:"30"},{n:"31",nn:"31"},{n:"32",nn:"32"},{n:"33",nn:"33"},{n:"34",nn:"34"},{n:"35",nn:"35"},{n:"36",nn:"36"},{n:"37",nn:"37"},{n:"38",nn:"38"},{n:"39",nn:"39"},{n:"40",nn:"40"},{n:"41",nn:"41"},{n:"42",nn:"42"},{n:"43",nn:"43"},{n:"44",nn:"44"},{n:"45",nn:"45"},{n:"46",nn:"46"},{n:"47",
nn:"47"},{n:"48",nn:"48"},{n:"49",nn:"49"},{n:"50",nn:"50"},{n:"51",nn:"51"},{n:"52",nn:"52"},{n:"53",nn:"53"},{n:"54",nn:"54"},{n:"55",nn:"55"},{n:"56",nn:"56"},{n:"57",nn:"57"},{n:"58",nn:"58"},{n:"59",nn:"59"}],l=[{s:"0",ss:"00"},{s:"1",ss:"01"},{s:"2",ss:"02"},{s:"3",ss:"03"},{s:"4",ss:"04"},{s:"5",ss:"05"},{s:"6",ss:"06"},{s:"7",ss:"07"},{s:"8",ss:"08"},{s:"9",ss:"09"},{s:"10",ss:"10"},{s:"11",ss:"11"},{s:"12",ss:"12"},{s:"13",ss:"13"},{s:"14",ss:"14"},{s:"15",ss:"15"},{s:"16",ss:"16"},{s:"17",
ss:"17"},{s:"18",ss:"18"},{s:"19",ss:"19"},{s:"20",ss:"20"},{s:"21",ss:"21"},{s:"22",ss:"22"},{s:"23",ss:"23"},{s:"24",ss:"24"},{s:"25",ss:"25"},{s:"26",ss:"26"},{s:"27",ss:"27"},{s:"28",ss:"28"},{s:"29",ss:"29"},{s:"30",ss:"30"},{s:"31",ss:"31"},{s:"32",ss:"32"},{s:"33",ss:"33"},{s:"34",ss:"34"},{s:"35",ss:"35"},{s:"36",ss:"36"},{s:"37",ss:"37"},{s:"38",ss:"38"},{s:"39",ss:"39"},{s:"40",ss:"40"},{s:"41",ss:"41"},{s:"42",ss:"42"},{s:"43",ss:"43"},{s:"44",ss:"44"},{s:"45",ss:"45"},{s:"46",ss:"46"},
{s:"47",ss:"47"},{s:"48",ss:"48"},{s:"49",ss:"49"},{s:"50",ss:"50"},{s:"51",ss:"51"},{s:"52",ss:"52"},{s:"53",ss:"53"},{s:"54",ss:"54"},{s:"55",ss:"55"},{s:"56",ss:"56"},{s:"57",ss:"57"},{s:"58",ss:"58"},{s:"59",ss:"59"}],p={yy:d(k,"yy"),yyyy:d(k,"yyyy"),YY:d(k,"YY"),YYYY:d(k,"YYYY"),m:d(m,"m"),mm:d(m,"mm"),mmm:d(m,"mmm"),mmmm:d(m,"mmmm"),M:d(m,"M"),MM:d(m,"MM"),MMM:d(m,"MMM"),MMMM:d(m,"MMMM"),d:d(t,"d"),dd:d(t,"dd"),dth:d(t,"dth"),ddth:d(t,"ddth"),D:d(u,"D"),DD:d(u,"DD"),DDD:d(u,"DDD"),DDDD:d(u,
"DDDD"),ddd:d(u,"ddd"),dddd:d(u,"dddd"),am:d(r,"am"),AM:d(r,"AM"),h:d(r,"h"),hh:d(r,"hh"),H:d(r,"H"),HH:d(r,"HH"),n:d(w,"n"),nn:d(w,"nn"),s:d(l,"s"),ss:d(l,"ss"),xxx:!0,xx:!0,x:!0};return c});jspyder.extend.fn("dialog",function(){function c(b){b=b||{};var a=d.dom(c.fn._template),f=Object.create(c.fn,{_element:{value:a},_buttonDefs:{value:[]}});f.setDimensions(b.width,b.height);a.find("i.button-close").on("click",function(a){f.remove()});b.noclose&&a.find("i.button-close").remove();b.title?f.setTitle(b.title):b.titleHtml&&f.setTitleHtml(b.titleHtml);b.body?f.setBody(b.body):b.bodyHtml&&f.setBodyHtml(b.bodyHtml);b.buttons&&f.setButtons(b.buttons);b.parent&&f.attach(b.parent);return f}var d=
this;c.alert=function(b){var a=c({titleHtml:d.alg.string(b.title,"Alert"),bodyHtml:d.alg.string(b.message,""),noclose:!0,parent:b.parent||document.body,height:b.height,width:b.width,buttons:[{text:"OK",value:"OK",click:function(c){a.remove();"function"===typeof b.callback&&b.callback()}}]});return a};c.confirm=function(b){var a=c({titleHtml:d.alg.string(b.title,"Alert"),bodyHtml:d.alg.string(b.message,""),noclose:!0,parent:b.parent||document.body,height:b.height,width:b.width,buttons:[{text:"OK",
value:"OK",click:function(c){a.remove();"function"===typeof b.callback&&b.callback(!0)}},{text:"Cancel",value:"Cancel",click:function(c){a.remove();"function"===typeof b.callback&&b.callback(!1)}}]});return a};c.query=function(b){var a=c({titleHtml:d.alg.string(b.title,"Alert"),bodyHtml:d.alg.string(b.message,""),noclose:!0,parent:b.parent||document.body,height:b.height,width:b.width,buttons:[{text:"Yes",value:"Yes",click:function(c){a.remove();"function"===typeof b.callback&&b.callback(!0)}},{text:"No",
value:"No",click:function(c){a.remove();"function"===typeof b.callback&&b.callback(!1)}}]});return a};c.fn={_element:null,_buttonDefs:null,_template:'<div class="js-dialog-background"><div class="js-dialog"><div class="js-dialog-header"><span class="title-container"></span><span class="dialog-buttons"><i class="button-close close"></i></span></div><div class="js-dialog-body"><div class="body-container"></div></div><div class="js-dialog-footer"><div class="footer-container"></div></div></div></div>',
_height:237.2,_width:498,_buttonFactory:function(b){b=["<div>",b,"</div>"].join("");return d.dom(b)},setBody:function(b){this._element&&this._element.find(".body-container").setHtml("").append(b);return this},setBodyHtml:function(b){this._element&&this._element.find(".body-container").setHtml(b);return this},setTitle:function(b){this._element&&this._element.find(".title-container").setHtml("").append(b);return this},setTitleHtml:function(b){this._element&&this._element.find(".title-container").setHtml(b);
return this},setButtons:function(b){if(this._element){var a=this._element.find(".footer-container").setHtml(""),c=d.form();d.alg.each(b,function(b,g){b=d.alg.mergeObj({},b,{type:"button"});c.addField("button-"+g,b);a.append(c.exportField("button-"+g))})}return this},setDimensions:function(b,a){return this.setHeight(a).setWidth(b)},setHeight:function(b){this._element&&(b=d.alg.number(b,this._height)+"px",this._element.find(".js-dialog-body").setCss({"max-height":b}));return this},setWidth:function(b){this._element&&
(b=d.alg.number(b,this._width)+"px",this._element.find(".js-dialog-body").setCss({width:b}));return this},attach:function(b){this._element&&this._element.attach(b);return this},remove:function(){this._element&&this._element.remove();return this}};return c});jspyder.extend.fn("download",function(){function c(a){var b=Object.create(c.fn);a=a||{};b.setName(a.name).setType(a.type).setData(a.data).setCharset(a.charset);return b}function d(c,d,h){d=a.alg.string(d,e);c=a.alg.string(c,"download.txt");if(t.test(h))return u?u(w(h),c):b(c,h);h=h instanceof k?h:new k([h],{type:d});if(u)return u(h,c);if(g)return"Chrome"===a.env.browser.name&&d!==e&&(h=m.call(h,0,h.size,e)),b(c,g.createObjectURL(h));if("string"===typeof h||h instanceof String)return b(c,"data:"+d+
r(h));d=new FileReader;d.onload=function(a){b(c,this.result)};d.readAsDataURL(h);return!0}function b(b,c){var d={download:null},h={href:c,download:b},f=a.dom("<a></a>").getProps(d),g="data:"+c.replace(l,e);null!==d.download?f.setAttrs(h).on("send-click",function(a){this.click();f.remove();q(c)}).attach(document.body).trigger("send-click"):"Safari"===a.env.browser.name?window.open(g)||(location.href=g,q(c)):a.dom("<iframe></iframe>").setCss({position:"fixed",left:"-9000000px",width:"1em",height:"1em"}).setProps({src:g}).on("load",
function(a){this.remove();q(c)}).attach(document.body);return!0}var a=window.jspyder;c.fn={save:function(a){a=a||{};d(a.name||this._name,a.type||this._type,a.data||this._data);return this},saveText:function(a){a=a||{};v(a.data||this._data,a.name||this._name,a.charset||this._charset);return this},saveMime:function(a){a=a||{};var b=(a.name||this._name).split("."),c=a.data||this._data,d=a.type||this._type;a=a.charset||this._charset;var f=".txt";1<b.length&&(f=b.pop());b=b.join("");h(c,b,f,d,a);return this},
setName:function(b){this._name=a.alg.string(b,"download");return this},getName:function(){return this._name},setType:function(b){this._type=a.alg.string(b,e);return this},getType:function(){return this._type},setData:function(a){this._data=a||"";return this},getData:function(){return this._data},setCharset:function(a){this._charset=a||"UTF-8";return this},getCharset:function(){return this._charset}};var f=window,e="application/octet-stream",g=window.URL||window.webkitURL||window,q=function(b){setTimeout(a.alg.bindFn(g,
g.revokeObjectURL,[b]),3E5)},k=f.Blob||f.MozBlob||f.WebKitBlob||null,m=k&&(k.prototype.slice||k.prototype.webkitSlice),t=/^data\:[\w+\-]+\/[\w+\-]+[,;]/,u=f.navigator.msSaveOrOpenBlob||f.navigator.msSaveBlob?function(){var b=f.navigator;return a.alg.use(b,b.msSaveOrOpenBlob||b.msSaveBlob,arguments)}:null,r=function(a){var b=f.btoa;r=f.btoa?function(a){return";base64,"+b(a)}:function(a){return","+encodeURIComponent(a)};return r(a)},w=function(b,c){var d=b.split(/[:;,]/),h=d[1],f=("base64"===d[2]?atob:
decodeURIComponent)(d.pop()),d=f.length,e=new Uint8Array(d);a.alg.iterate(0,d,function(a){e[a]=f.charCodeAt(a)});return new k([e],{type:h})},l=/^data:([\w\/\-\+]+)/,p={"UTF-8":"","UTF-16":"\ufeff","UTF-32":"\x00\ufeff","UTF-7":"+/v8","UTF-1":"\u00f7dL"},h=function(b,c,f,e,g){h=window.Blob?function(b,c,h,f,e){e=a.alg.string(e,"UTF-8");c=a.alg.string(c,"download");b=b||"";(h=a.alg.string(h,""))&&(c+="."+h);b=new window.Blob([(p[e]||"")+b],{type:f+";charset="+e});d(c,f,b)}:"IE"===a.env.browser&&9>=a.env.browserVersion?
function(b,c,d,h,f){f=a.alg.string(f,"UTF-8");c=a.alg.string(c,"download");b=b||"";a.dialog.alert({title:"Alert",message:["Because you are using Internet Explorer ",a.env.browserVersion,', your download "',c,".",d,'" has been changed to "',c,'.txt".  It is recommended that this value be changed in the save menu, or after the file has been downloaded.'].join("")});v(b,c,f)}:function(b,c,d,h,f){f=a.alg.string(f,"UTF-8");c=a.alg.string(c,"download");v(b||"",c+"."+d,f)};return h.apply(this,arguments)},
v=function(b,c,h){b=b.replace(/\r?\n/g,"\r\n");v=window.Blob?function(b,c,h){h=a.alg.string(h,"UTF-8");c=a.alg.string(c,"download");b=new k([b||""],{type:"text/plain;charset="+h});d(c,"text/text",b)}:function(b,c,d){d=a.alg.string(d,"UTF-8");c=a.alg.string(c,"download");b=b||"";var h="",f=window.frames.saveTxtWindow;if(!f&&(f=document.createElement("iframe"),f.id="saveTxtWindow",f.style.display="none",document.body.insertBefore(f,null),f=window.frames.saveTxtWindow,!f&&(f=window.open("","_temp","width=100,height=100"),
!f)))return window.alert("Sorry, download file could not be created."),!1;h=f.document;h.open("text/html","replace");h.charset=d;/\.htm(l)?$/i.test(c)?(h.close(),h.body.innerHTML="\r\n"+b+"\r\n"):(/\.txt$/i.test(c)||(c+=".txt"),h.write(b),h.close());h=h.execCommand("SaveAs",null,c);f.close();return h};return v.apply(this,arguments)};return c});jspyder.extend.fn("dtype",function(){function c(a,b){var d=Object.create(c.fn);d.obj=a;e.alg.use(d,a);return d}function d(a,b,c){throw new TypeError("Attempted to assign "+typeof b+"("+b+") to "+c+' "'+a+'"');}function b(a,b){throw new TypeError("Attempted to set a value to a constant "+b+' "'+a+'"');}function a(a,c,f,e,g,r,w,l,p,h){f={};var v="function"===typeof l?function(a){g=e(l(a))}:function(a){g=e(a)},n="function"===typeof h?function(b){typeof b===c||d(a,b,c);v(b)}:function(b){h(b)||d(a,b,c);
v(b)},y=function(d){b(a,c)},x="function"===typeof p?function(){return p(e(g))}:function(){return e(g)};v(g);f.get=x;f.enumerable=!0;f.set=r?y:w?n:v;return f}function f(a,b,c){Object.defineProperty(a,b,c);return a}var e=this,g=e.alg;c.fn={"byte":e.alg.use(c,function(){g.byte();var b=g["byte"];return function(c,d,e,g){var r=this.obj;d=a(c,"number","byte",b,d,g,e);f(r,c,d);return this}}),ubyte:e.alg.use(c,function(){g.ubyte();var b=g.ubyte;return function(c,d,e,g){var r=this.obj;d=a(c,"number","unsigned byte",
b,d,g,e);f(r,c,d);return this}}),"short":e.alg.use(c,function(){g.short();var b=g["short"];return function(c,d,e,g){var r=this.obj;d=a(c,"number","short",b,d,g,e);f(r,c,d);return this}}),ushort:e.alg.use(c,function(){g.short();var b=g.ushort;return function(c,d,e,g){var r=this.obj;d=a(c,"number","unsigned short",b,d,g,e);f(r,c,d);return this}}),"int":e.alg.use(c,function(){g.int();var b=g["int"];return function(c,d,e,g){var r=this.obj;d=a(c,"number","integer",b,d,g,e);f(r,c,d);return this}}),uint:e.alg.use(c,
function(){g.uint();var b=g.uint;return function(c,d,e,g){var r=this.obj;d=a(c,"number","unsigned integer",b,d,g,e);f(r,c,d);return this}}),"float":e.alg.use(c,function(){g.float();var b=g["float"];return function(c,d,e,g){var r=this.obj;d=a(c,"number","float",b,d,g,e);f(r,c,d);return this}}),"double":e.alg.use(c,function(){g.double();var b=g["double"];return function(c,d,e,g){var r=this.obj;d=a(c,"number","double",b,d,g,e);f(r,c,d);return this}}),fixed:e.alg.use(c,function(){function b(a){a=g.int(a);
a=Math.pow(10,a);return function(b){return c(b*a)/a}}g.int();var c=g.int;return function(c,d,e,g,k){var l=b(e);e=this.obj;d=a(c,"number","fixed",l,d,k,g);f(e,c,d);return this}}),ufixed:e.alg.use(c,function(){function b(a){a=g.int(a);a=Math.pow(10,a);return function(b){return c(b*a)/a}}g.int();var c=g.int;return function(c,d,e,g,k){var l=b(e);e=this.obj;d=a(c,"number","fixed",l,d,k,g);f(e,c,d);return this}}),currency:function(a,b,c,d){return this.fixed(a,b,2,c,d)},string:e.alg.use(c,function(){g.string();
var b=g.string;return function(c,d,e,g){var r=this.obj;d=a(c,"string","string",b,d,g,e);f(r,c,d);return this}}),uchar:e.alg.use(c,function(){g.string();g.ushort();var b=g.string,c=g.ushort,d=function(a){if("number"===typeof a)return c(a);a=b(a);return a.length?a.charCodeAt(0):0},e=function(a){return"string"===typeof a&&1===a.length||"number"===typeof a};return function(b,c,g,q){var p=this.obj;c=a(b,null,"uchar",d,c,q,g,null,null,e);f(p,b,c);return this}}),bool:e.alg.use(c,function(){g.bool();var b=
g.bool;return function(c,d,e,g){var r=this.obj;d=a(c,"boolean","bool",b,d,g,e);f(r,c,d);return this}}),bit:e.alg.use(c,function(){g.bool();var b=g.bool,c=function(a){return+b(a)},d=function(a){return"number"===typeof a&&(1===a||0===a)||"boolean"===typeof a};return function(b,e,g,q){var l=this.obj;e=a(b,"number","bit",c,e,q,g,null,null,d);f(l,b,e);return this}}),"enum":e.alg.use(c,function(){g.makeEnum();var a=g.makeEnum,c=function(a,c,f,g,q){function l(c){b(a,"enum")}function p(b){"number"!==typeof b&&
d(a,b,"enum");h(b)}function h(a){a=e.alg.number(a)|0;var b=0;e.alg.arrEach(k,function(c){(a&c)===c&&(b|=c);a<c&&this.stop()});f=b}var v={},n={valueOf:function(){return f}},k=[];f=e.alg.number(f);e.alg.each(c,function(c,h){if("valueOf"!==h){var n=function(b){"boolean"!==typeof b&&"number"!==typeof b&&d(a+"."+h,b,"number/boolean");p(b)},p=function(a){f=e.alg.number(a?f|c:f-(f&c))|0},l=function(c){b(a+"."+h,"number")};k.push(c);v[h]={enumerable:!0,get:function(){return e.alg.number(f&c)|0},set:q?l:g?
n:p}}});e.alg.sortArrayNum(k,!0);Object.defineProperties(n,v);return{enumerable:!0,get:function(){return n},set:q?l:g?p:h}};return function(b,d,e,g,w){var l=this.obj;d=c(b,Array.isArray(e)?a(e):e,d,g,w);f(l,b,d);return this}})};e.alg.use(c.fn,function(){this.int8=this["byte"];this.uint8=this.ubyte;this.int16=this["short"];this.uint16=this.ushort;this.int32=this["int"];this.uint32=this.uint});return c});jspyder.extend.fn("form",function(){function c(b,a){var f=Object.create(c.fn,{_dom:{value:d.dom("<form></form>")},_template:{value:{}}});b&&(b.success&&(f._success=b.success),b.failure&&(f._failure=b.failure),b.reset&&(f._reset=b.reset),b.fields&&f.addFields(b.fields));d.alg.use(f,a);return f}var d=this;c.fn={_success:function(b,a){return this},_failure:function(b,a){return this},_reset:function(){return this},_dom:null,_fields:null,each:function(b,a){d.alg.each(this._fields,b,a);return this},addFields:function(b){for(var a in b)this.addField(a,
b[a]);return this},addField:function(b,a){b=d.alg.string(b,"");a=d.alg.object(a,{});var f=Object.create(c.fn.fieldTemplate),e=null;d.alg.mergeObj(f,a,{name:b,"default":a.default,value:a.value,values:d.alg.sliceArray(a.values)});e=this.buildControl(f);this._fields||(this._fields={});this._fields[b]={type:f.type,field:e,validate:f.validate,exportValue:f.exportValue,getValue:f.getValue,setValue:f.setValue,ignore:f.ignore,config:f};this.resetFieldValue(b);this.bindEvents(e,f);return this},bindEvents:function(b,
a){var c=this;d.alg.each(a&&a.events,function(a,g){b.on(g,function(b){d.alg.use(this,a,[b,c])})});return this},registerControl:function(b,a){c.fn.templates[b]=a;return this},registerControlFn:function(b,a){this.registerControl(b,d.alg.use(this,a));return this},buildControl:function(b,a){var c=(this.templates[b.type]||this.templates.input).apply(this,[b]),e=d.alg.string(b.name),g=d.alg.string(b.text),q=!d.alg.bool(b.nolabel,a);return this.buildLabel(q&&e,q&&g,b.class,b.tooltip).and(c)},buildLabel:function(b,
a,c,e){b=b&&a?["<label ",b?'for="'+b+'" ':"",c?'class="'+c+'"':"",e?'title="'+e+'"':"",">",a,"</label>"].join(""):"";return d.dom(b)},getField:function(b,a){var c=this.exportField(b);d.alg.use(this,a,[c]);return this},exportField:function(b){return(b=this.exportFieldData(b))?b.field:null},getFieldData:function(b,a){var c=this.exportFieldData(b);d.alg.use(this,a,[c]);return this},exportFieldData:function(b){return this._fields[b]||null},resetFieldValue:function(b){var a=this.exportFieldData(b),c=a.config.default,
a=a.config.value;this.setFieldValue(b,"undefined"!==typeof a?a:c);return this},resetFieldValues:function(){this.each(this._resetFieldValues,this)},_resetFieldValues:function(b,a,c,d){d.resetFieldValue(a)},setFieldValue:function(b,a){var c=this.exportFieldData(b),e=this.exportField(b);e&&(c&&c.setValue?d.alg.use(e,c.setValue,[c,a]):e.setValue(a));return this},getFieldValue:function(b,a){var c=[this.exportFieldValue(b)];d.alg.use(this,a,c);return this},exportFieldValue:function(b){var a=this.exportFieldData(b);
b=this.exportField(b);var c=null;b&&(a&&a.exportValue?c=d.alg.use(b,a.exportValue,[a]):a&&a.getValue?d.alg.use(b,a.getValue,[a,function(a){c=a}]):c=b.exportValue());return c},templates:{},values:function(b){var a={},c,e,g=function(b){a[e]=c};for(e in this._fields)c=this._fields[e].field,a[e]=null,c.getValue(g);d.alg.use(this,b,[a]);return this},fieldTemplate:{type:"input",values:[]},submit:function(b,a){b="function"===typeof b?b:this._success;a="function"===typeof a?a:this._failure;this.validate(function(c,
e){d.alg.use(this,e?a:b,[c,e])});return this},reset:function(b){this.resetFieldValues();d.alg.use(this,"function"===typeof b?b:this._reset);return this},validate:function(b){var a=this,c={},e=null;this.each(function(b,d){var k=!0,m=a.exportFieldValue(d);if(!b.ignore){switch(typeof b.validate){case "function":k=b.validate(a);break;case "boolean":k=b.validate}b.config.required&&!m&&(k=!1);(k?c:e||(e={}))[d]=m}});d.alg.use(this,b,[c,e]);return this},attach:function(b,a){var c=this._dom,e=this._fields,
g;for(g in e);d.alg.use(c,b,[this,c,a]);return this},compile:function(b,a,c){return this._compiler(b,a,c,"compile")},compileExplicit:function(b,a,c){return this._compiler(b,a,c,"compileExplicit")},compileDom:function(b,a,c){if((b=d.dom(b))&&b.getHtml){var e=this;b.getHtml(function(d){e._compiler(d,a,c,b)})}return b},_compiler:function(b,a,c,e){var g=null;if("string"!==typeof e)g=e;else d.template(a)[e](b,null,function(a){g=d.dom(a)});this._dom=g;var q={};d.alg.each(this._fields,function(a,b){q[b]=
a.field});g.template(q||{});d.alg.use(this,c,[g]);return g}};c.registerControl=c.fn.registerControl;c.registerControlFn=c.fn.registerControlFn;c.registerControlFn("input",function(){function b(a,b){this.setValue(d.alg.string(b))}return function(a){var c=d.alg.string(a.name),e=d.alg.string(a.class),g=d.alg.string(a.type,"text"),c=['<input class="',e,'" name="',c,'"',a.readonly?' readonly="readonly"':"",' data-type="',g,'"></input>'].join("");a.setValue=b;return d.dom(c)}}).registerControlFn("date",
function(){function b(a){var c=Object.create(b.fn);c.today=d.date();c.date=d.date(a.value,a.format);c.format=d.alg.string(a.format,c.format);return c}b.fn={dom:null,title:null,tiles:null,prev:null,next:null,input:null,today:null,date:null,DOCDOM:d.dom(document.documentElement),navMonth:!1,titleMonth:"mmm yyyy",titleYear:"yyyy",format:"yyyy-mm-dd",clear:function(){this.dom&&this.dom.remove();this.input=this.next=this.prev=this.tiles=this.title=this.dom=null;this.navMonth=!1;this.today=d.date();return this},
load:function(){var a=d.dom(this.calendarHtml),b=this;this.today=d.date();this.dom=a;this.title=a.find(".date-picker-title");this.tiles=a.find(".calendar-tiles");this.prev=a.find(".date-picker-prev");this.next=a.find(".date-picker-next");this.prev.on("click",function(a){b.prevNextClick(-1)});this.next.on("click",function(a){b.prevNextClick(1)});this.setTitle();this.monthlistInit();a.on("click",this.preventClose);return this},setTitle:function(a){var b=this;b.title.setHtml(this.date.asString(this.navMonth?
this.titleMonth:this.titleYear));this.input.getValue(function(c){(a||c)&&this.setValue(b.date.asString(this.format))});return this},setTiles:function(a){this.tiles.setHtml(a);return this},enableClose:function(){this.pause=!1},preventClose:function(){this.pause=!0},prevNextClick:function(a){this.date[this.navMonth?"addMonths":"addYears"](a);this.setTitle();this.navMonth?this.monthClick(this):this.monthlistInit();this.preventClose()},monthlistInit:function(){function a(c){b.date.setMonth(c);b.monthClick(b)}
var b=this;this.months="";d.alg.arrEach(this.date.exportMonthList("mmm"),this.monthlistBuilder,this);this.setTiles(b.months);this.tiles.find(".month").on("click",function(b){d.dom(this).getValue(a)})},monthlistBuilder:function(a,b,c,d){c=d.today.exportYear()===d.date.exportYear();var k=b+1===d.today.exportMonth();d.months+=['<div class="month ',c&&k?"today":"",'" value="',b+1,'">',a,"</div>"].join("")},monthClick:function(){var a=this;a.today=d.date();var b=a.date.exportWeekdayList("DD"),c=a.date.exportDayList("d"),
q=0,k={html:"",wlen:b.length,offset:a.date.exportWeekdayOffset(),calStruct:a,today:a.today.exportMonth()===a.date.exportMonth()&&d.date().exportDay()};for(d.alg.arrEach(b,a.buildWeekdays,k);q<k.offset;)this.buildNumberedDays("",q-k.offset,null,k),q++;d.alg.arrEach(c,this.buildNumberedDays,k);a.navMonth=!0;a.setTiles(k.html);a.tiles.find(".date").on("click",function(b){d.dom(this).getValue(function(b){a.date.setDay(b);a.setTitle(!0);d.dom(a.input).trigger("change")});a.enableClose()});a.setTitle();
a.preventClose();d.dom(a.input).trigger("change")},buildWeekdays:function(a,b,c,d){d.html+=['<div class="date-title date-title-index-',b+1,'" style="width:',100/d.wlen,'%">',a,"</div>"].join("")},buildNumberedDays:function(a,b,c,q){var k=q.calStruct.today.exportYear()===q.calStruct.date.exportYear(),m=q.calStruct.today.exportMonth()===q.calStruct.date.exportMonth(),t=q.calStruct.today.exportDay()===b+1;q.html+=['<div class="date ',k&&m&&t?"today":"",'" value="',b+1,'" style="width:',100/q.wlen,"%;",
d.alg.bool(c)?"":"visibility: hidden;",'">',a,"</div>"].join("")},calendarHtml:'<div class="js-control js-control-date-picker"><div class="date-picker-header"><i class="chevron-left date-picker-prev"></i><h4 class="date-picker-title">${YEAR}</h4><i class="chevron-right date-picker-next"></i></div><div class="calendar-tiles"></div></div>'};var a={type:"input"};return function(c){var e=this.buildControl(d.alg.mergeObj({},c,a),!0),g=b(c);e.filter("input").on("click",function(a){a={readonly:null};d.dom(this).getAttrs(a);
a.readonly||(a=this.value||c.value||c.default||new Date,g.clear(),g.input=d.dom(this),g.date.setDate(a,g.format),g.load().preventClose(),d.dom(this.parentNode).append(g.dom),g.DOCDOM.on("click",function m(a){if(g.pause)return g.enableClose();g.clear();g.DOCDOM.off("click",m)}))});c.exportValue=function(){return e.exportValue()?g.date.asDate():null};c.setValue=function(a,b){g.date.setDate(b||NaN,g.format);this.setValue(g.date.asString(g.format))};return e}}).registerControlFn("button",function(){function b(a,
b){return function(c){var g={readonly:null};d.dom(this).getAttrs(g);g.readonly||d.alg.use(this,b,[c,a])}}return function(a){a.nolabel=!0;var c=d.alg.string(a.class,""),e=d.alg.string(a.icon,""),g=d.alg.string(a.text,""),q=d.alg.string(a.name,""),k=d.alg.string(a.value,""),c=['<div class="js-control js-control-button ',c,'"',a.readonly?' readonly="true"':"",' name="',q,'">','<i class="'+e+'"></i>','<span class="button-text" data-buttontext="'+g+'"></span>',"</div>"].join("");return d.dom(c).setValue(k).on("click",
b(this,a.click))}}).registerControlFn("buttonset",function(){var b={type:"button"};return function(a){for(var c=d.dom(),e=0;e<a.buttons.length;e++){var g=d.alg.mergeObj({readonly:a.readonly},a.buttons[e],b);g.class+=" js-buttonset";c.and(this.buildControl(g,!0))}return c}}).registerControlFn("submit",function(){function b(a){return function(b){b={readonly:null};d.dom(this).getAttrs(b);b.readonly||a.submit()}}var a={type:"button",nolabel:!0};return function(c){c=this.buildControl(d.alg.mergeObj(c,
a),!0);c.on("click",b(this));return c}}).registerControlFn("reset",function(){function b(a){return function(b){b={readonly:null};d.dom(this).getAttrs(b);b.readonly||a.reset()}}var a={type:"button",nolabel:!0};return function(c){c=this.buildControl(d.alg.mergeObj(c,a),!0);c.on("click",b(this));return c}}).registerControlFn("dropdown",function(){function b(b){return function(c){c=d.dom(this);var e={readonly:null};c.getAttrs(e);e.readonly||a(c,b)}}function a(a,b){function c(b){a.setValue(b)}function f(b){a.find(".dropdown-text").setHtml(b)}
for(var t=b.values,u=d.dom('<ul class="dropdown-selection"></ul>'),r=null,w=r="",w="",l=!0,p=0;p<t.length;)r=t[p],w=d.alg.string(r.text,r.value),r=d.alg.string(r.value,r.text),w=['<li class="item" value="',r,'" title="',w,'">',w,"</li>"].join(""),u.append(w),p++;u.on("click",function(a){a.target.parentNode===this&&d.dom(a.target).getValue(c).getHtml(f);e.trigger("click");a.stopPropagation&&a.stopPropagation();a.stopImmediatePropagation&&a.stopImmediatePropagation()}).attach(a);e.on("click",function v(b){if(l)return l=
!1;u&&u.remove();a=u=null;e.off("click",v)})}function c(a,b){b=d.alg.string(b);var e=this;d.alg.each(a.config.values,function(a){var c=d.alg.string(a.value,a.text);a=d.alg.string(a.text,a.value);b===c&&(e.setValue(c).find(".dropdown-text").setHtml(a),this.stop())})}var e=d.dom(document.documentElement);return function(a){var e=d.alg.string(a.name,""),k=d.alg.string(a.class,""),m=d.alg.string(a.value,""),t=d.alg.string(a.default,""),e=['<div name="',e,'" tabindex="0"',a.readonly?' readonly="true"':
"",' class="input js-control js-control-dropdown ',k,'"><i class="dropdown-arrow arrow-drop-down"></i><span class="dropdown-text">',m||t||"&nbsp;","</span></div>"].join(""),e=d.dom(e);e.on("click",b(a));a.setValue=c;return e}}).registerControlFn("textarea",function(){function b(a,b){b=d.alg.string(b,"");this.setValue(b)}return function(a){var c=d.alg.string(a.name,""),e=d.alg.string(a.class,""),c=['<textarea name="',c,'"',a.readonly?' readonly="true"':"",' class="input ',e,'"></textarea>'].join("");
a.setValue=b;return d.dom(c)}}).registerControlFn("textarea-autosize",function(){function b(a,b){b=d.alg.string(b,"");this.setValue(b)}function a(a){var b={readonly:null};a=null;d.dom(this).getAttrs(b);if(!b.readonly){a=document.createElement("div");b={"font-family":null,"font-size":null,"font-weight":null,"padding-left":null,"padding-right":null,"padding-bottom":null,"padding-top":null,"border-left":null,"border-right":null,"border-top":null,"border-bottom":null,"line-height":null,"word-wrap":null};
a.style.position="fixed";a.style.left="-65535px";a.style["white-space"]="pre-wrap";a.style["white-space"]="-moz-pre-wrap";a.style["white-space"]="-pre-wrap";a.style["white-space"]="-o-pre-wrap";a.style.width=a.style["min-width"]=a.style["max-width"]=this.clientWidth+"px";document.body.appendChild(a);var c=d.dom(this).getCss(b);d.dom(a).setText(this.value).setCss(b).getPosition(function(a){c.setCss({height:a.height+20+"px"})}).remove()}}return function(c){var e=d.alg.string(c.name,""),g=d.alg.string(c.class,
""),e=['<textarea name="',e,'" class="input js-control js-control-autosize ',g,'"></textarea>'].join("");c.setValue=b;c=d.dom(e);c.on("input",a);return c}}).registerControlFn("radio",function(){function b(a){var b=d.alg.string(a.text,""),c=d.alg.string(a.value,""),f=d.alg.string(a.name,""),m=d.alg.string(a.class,"");a=['<input value="',c,'" name="',f,'" type="radio"',a.readonly?' readonly="true"':"",' class="',m,'"></input>'].join("");return d.dom(a).and(d.form.fn.buildLabel(f,b,m))}function a(a){return a.config["data-value"]||
null}function c(a,b){this.find("input[type=radio]").each(function(a){var c={checked:null},e=null;d.dom(a).getProps(c).getAttrs({value:""},function(a){e=c.checked;b&&b.indexOf&&(c.checked=-1<b.indexOf(a.value))}).setProps(c).trigger(c.checked!==e?"change":"")});return this}return function(e){var g=d.alg.string(e.name,""),q=d.alg.string(e.class,""),k=e.values||[],m=null,m=null,t=d.dom(),u;e["data-values"]={};for(u=0;u<k.length;u++)m=d.alg.mergeObj({name:g,"class":q,readonly:e.readonly},k[u]),m.class=
q+d.alg.string(k[u].class),m=d.dom("<div></div>").append(b(m)),t.and(m);var r=this;t.find("input").on("change",function(a){a={readonly:null};var b=d.dom(this);b.getAttrs(a);a.readonly?r.setFieldValue(g,r.exportFieldValue(g)):b.getValue(function(a){e["data-value"]=a})});e.exportValue=a;e.setValue=c;return t}}).registerControlFn("checkbox",function(){function b(a){var b=[],c;a=a.config["data-values"]=a.config["data-values"]||{};for(c in a)a[c]&&b.push(c.substring(4));return b}function a(a,b){this.find("input[type=checkbox]").each(function(a){var c=
{checked:null},e=null;d.dom(a).getProps(c).getAttrs({value:""},function(a){e=c.checked;b&&b.indexOf&&(c.checked=-1<b.indexOf(a.value))}).setProps(c).trigger(c.checked!==e?"change":"")});return this}function c(a){var b=d.alg.string(a.text,""),f=d.alg.string(a.value,""),k=d.alg.string(a.name,""),m=d.alg.string(a.class,"");a=['<input value="',f,'" name="',k,'" type="checkbox"',a.readonly?' readonly="true"':"",' class="',m,'"></input>'].join("");return d.dom(a).and(d.form.fn.buildLabel(k,b,m))}return function(e){var g=
d.alg.string(e.name,""),q=d.alg.string(e.class,""),k=e.values||[],m=null,m=null,t=d.dom(),u;e["data-values"]={};for(u=0;u<k.length;u++)m=d.alg.mergeObj({name:g,readonly:e.readonly},k[u]),m.class=q+d.alg.string(k[u].class),m=d.dom("<div></div>").append(c(m)),t.and(m);t.find("input").on("change",function(a){var b=this.checked;a=d.dom(this);var c={readonly:null};a.getAttrs(c);c.readonly?this.checked=!b:a.getValue(function(a){e["data-values"]["val-"+d.alg.string(a)]=b})});e.exportValue=b;e.setValue=a;
return t}}).registerControlFn("toggles",function(){function b(a){var b=[];this.filter(".js-buttonset").each(function(a){d.dom(a).getAttrs({"data-value":null,"data-checked":null},function(a){a["data-checked"]&&b.push(a["data-value"])})});return b}function a(a,b){this.filter(".js-buttonset").each(function(a){var c={"data-value":"","data-checked":null},e=null;d.dom(a).getAttrs(c,function(a){e=a["data-checked"];b&&b.indexOf&&(a["data-checked"]=-1<b.indexOf(a["data-value"])?!0:null)}).setAttrs(c).trigger(c["data-checked"]!==
e?"change":"")});return this}function c(a){var b=d.alg.string(a.text,""),f=d.alg.string(a.value,""),k=d.alg.string(a.class,"");return d.form.fn.buildControl({type:"button",text:b,class:k+" js-buttonset",readonly:a.readonly,click:function(a,b){d.dom(this).getAttrs({"data-checked":!1,readonly:!1},function(a){a.readonly||(a["data-checked"]=d.alg.bool(a["data-checked"])?null:!0,this.setAttrs(a))})}}).setAttrs({"data-checked":null,"data-value":f})}return function(e){var g=d.alg.string(e.name,""),q=d.alg.string(e.class,
""),k=e.values||[],m=null,m=null,t=d.dom(),u;e["data-values"]={};for(u=0;u<k.length;u++)m=d.alg.mergeObj({name:g,readonly:e.readonly},k[u]),m.class=q+" "+d.alg.string(k[u].class),m=d.dom(c(m)),t.and(m);e.exportValue=b;e.setValue=a;return t}}).registerControlFn("toggles-radio",function(){function b(a){var b=null;this.filter(".js-buttonset[data-checked]").at(0).getAttrs({"data-value":null,"data-checked":null},function(a){b=a["data-value"]});return b}function a(a,b){this.filter('.js-buttonset[data-checked]:not([data-value="'+
b+'"])').setAttrs({"data-checked":null}).trigger("change");this.filter('.js-buttonset[data-value="'+b+'"]:not([data-checked])').setAttrs({"data-checked":!0}).trigger("change");return this}var c={type:"toggles",nolabel:!0};return function(e){var g=d.alg.mergeObj({},e,c),g=this.buildControl(g,!0),q=this;g.on("click",function(a){var b=d.dom(this);d.alg.each(e.values,function(a){b.getAttrs({"data-value":null,readonly:null},function(a){a.readonly||q.setFieldValue(e.name,a["data-value"])})})});e.exportValue=
b;e.setValue=a;return g}}).registerControlFn("toggles-bitwise",function(){function b(a){var b=d.alg.use(this,c,arguments),e=0;d.alg.each(b,function(a){e|=d.alg.number(a)});return e}function a(a,b){b=d.alg.number(b,0);this.filter(".js-buttonset").each(function(a){var c={"data-value":"","data-checked":null},e=null;d.dom(a).getAttrs(c,function(a){e=a["data-checked"];a["data-value"]=d.alg.number(a["data-value"],0);a["data-checked"]=b===a["data-value"]||b&a["data-value"]?!0:null}).setAttrs(c).trigger(c["data-checked"]!==
e?"change":"")});return this}var c=null,e={type:"toggles",nolabel:!0};return function(g){var q=d.alg.mergeObj({},g,e),k=this.buildControl(q,!0);g["data-values"]=q["data-values"];c=c||q.exportValue;g.exportValue=b;g.setValue=a;return k}}).registerControlFn("checkbox-bitwise",function(){function b(a){var b=d.alg.use(this,c,arguments),e=0;d.alg.each(b,function(a){e|=d.alg.number(a)});return e}function a(a,b){b=d.alg.number(b,0);this.find("input[type=checkbox]").each(function(a){var c={checked:null},
e=null;d.dom(a).getProps(c).getAttrs({value:""},function(a){e=c.checked;a.value=d.alg.number(a.value,0);c.checked=b===a.value||b&a.value}).setProps(c).trigger(c.checked!==e?"change":"")});return this}var c=null,e={type:"checkbox",nolabel:!0};return function(g){var q=d.alg.mergeObj({},g,e),k=this.buildControl(q,!0);g["data-values"]=q["data-values"];c=c||q.exportValue;g.exportValue=b;g.setValue=a;return k}}).registerControlFn("hidden",function(){var b={nolabel:!0,type:"input"},a={display:"none"};return function(c){var e=
d.alg.mergeObj({},c,b),g=this.buildControl(e,!0).setCss(a);c.setValue=e.setValue;return g}}).registerControlFn("autocomplete",function(){function b(b,c,f){function g(a){d.dom(this).getAttrs({"data-value":null},function(a){b.setFieldValue(f.name,a["data-value"])})}var k=d.dom('<ul class="js-control js-autocomplete-search"></ul>');c.on("keydown",function(a){var b={readonly:null};d.dom(this).getAttrs(b);if(!b.readonly)switch(b=!1,a.keyCode){case d.alg.keycodes.KC_UpArrow:b=!0;case d.alg.keycodes.KC_DownArrow:var c=
-1;k.find(".search-item").each(function(a,b){var h={selected:!1};d.dom(a).getClasses(h);h.selected&&(c=b)});k.find(".search-item").setClasses({selected:!1}).at(c+(b?-1:1)).setClasses({selected:!0});break;case d.alg.keycodes.KC_Tab:case d.alg.keycodes.KC_Enter:k.find(".search-item.selected").trigger("mousedown")}}).on("blur",function(a){a={readonly:null};d.dom(this).getAttrs(a);a.readonly||(""===this.value?d.dom(this).setAttrs({"data-value":""}):f.strict?(a=e(f,this.value,!0))?(this.value=a.text,d.dom(this).setAttrs({"data-value":a.value})):
(this.value="",d.dom(this).setAttrs({"data-value":""})):d.dom(this).setAttrs({"data-value":this.value}),l.hide())});var l={show:function(b){var c=f.values||[],e=d.alg.number(f.minlen,3),n={match:[],regexp:new RegExp(d.alg.escapeString(b),"i"),depth:d.alg.number(f.length,5)};b.length>=e?(d.alg.arrEach(c,a,n),b={width:0},this.getCss(b),k.setHtml(n.match.join("")).attachEnd(this).setCss(b).find(".search-item").on("mousedown",g)):k.remove()},hide:function(){k.remove()},getFirst:function(){}};return l}
function a(a,b,c,e){b=d.alg.string(a.value);a=d.alg.string(a.text,b);e.regexp.test(a)&&e.match.push('<li class="search-item" data-value="'+b+'" title="'+a+'">'+a+"</li>");e.match.length>=e.depth&&this.stop()}function c(a,b,e,f){b=d.alg.string(a.value);a=d.alg.string(a.text,b);f.find.test(f.searchText?a:b)&&(f.match={value:b,text:a},this.stop())}function e(a,b,e){b={match:null,find:new RegExp("^"+b+"$"),searchText:e};d.alg.arrEach(a.values,c,b);return b.match}function g(a,b){var c=a.field,f=d.alg.bool(a.config.strict),
g="",l={};(g=e(a.config,b,!1))?(l["data-value"]=g.value,g=g.text):f?g=l["data-value"]="":(l["data-value"]=d.alg.string(b,""),g=d.alg.string(b,""));c.setAttrs(l).setValue(g)}function q(a,b){var c="";a.field.getAttrs({"data-value":null},function(a){c=a["data-value"]});c||a.config.strict||a.field.getProps({value:null},function(a){c=a.value});return c}var k={type:"input"};return function(a){var c=d.alg.mergeObj({},a,k),e=this.buildControl(c,!0),f=null;a.setValue=g;a.exportValue=q;f=b(this,e,a);e.on("focus input",
function(a){a={readonly:null};d.dom(this).getAttrs(a);a.readonly||e.getValue(f.show)});return e}}).registerControlFn("number",function(){function b(a,b){b=d.alg.string(b,"");a.field.filter("input").getAttrs({"data-focus":!1},function(e){if(e["data-focus"])b=c(b,a.config.acc);else{var m=b;e=a.config.tsep;var t=a.config.dec,u=a.config.acc;""===d.alg.string(m,"")?b=m:(m=d.alg.number(m,0),e=d.alg.string(e,","),t=d.alg.string(t,"."),"undefined"!==typeof u&&(m=m.toFixed(u)),m=d.alg.string(m,"").split("."),
u=[],u[0]=(m[0]||"").replace(/\B(?=(\d{3})+(?!\d))/g,e),m[1]&&u.push(m[1]),b=u.join(t))}this.setValue(b)})}function a(a,b){b=this.filter("input").exportValue();b=b.replace(/([^\d\.])/g,"");return c(b)}function c(a,b){a=d.alg.string(a,"");var e=null;a=a.replace(/([^\-\d\.]+)/g,"");(e=a.split("."))?(e[0]=d.alg.number(e[0],0),e[1]=d.alg.string(e[1],"0"),a=d.alg.number(e[0]+"."+e[1],0)):a=0;"undefined"!==typeof b&&(a=a.toFixed(b));return a}var e={type:"input"};return function(c){var f=d.alg.mergeObj({},
c,e,{"class":d.alg.string(c.class,"")+" data-number"}),f=this.buildControl(f,!0),k=this;c.setValue=b;c.exportValue=a;f.filter("input").on("blur",function(a){a={readonly:null};d.dom(this).getAttrs(a);a.readonly||(a=d.dom(this).setAttrs({"data-focus":null}),k.setFieldValue(c.name,a.exportValue()))}).on("focus",function(a){a={readonly:null};d.dom(this).getAttrs(a);a.readonly||(a=d.dom(this).setAttrs({"data-focus":!0}),k.setFieldValue(c.name,a.exportValue()))});return f}}).registerControlFn("currency",
function(){var b={type:"number"};return function(a){var c=d.alg.mergeObj({},a,b,{"class":d.alg.string(a.class,"")+" data-currency"}),e=this.buildControl(c,!0),g='<div class="js-control js-control-currency-prefix">'+d.alg.string(a.prefix,"$")+"</div>";Object.defineProperty(a,"acc",{get:function(){return c.acc},set:function(a){c.acc=a}});a.setValue=c.setValue;a.exportValue=c.exportValue;a.acc=d.alg.number(a.acc,2);return d.dom(g).and(e)}});return c});jspyder.extend.fn("sp",function(){function c(){}function d(a,b,c,d){p.alg.use(this,b,[c,d,a]);this._dirtyRows.length=0;this.pull()}function b(a,b,c,d){p.alg.use(this,b,[c,d,a])}function a(a,b,c,d){a=a.getEnumerator();var e=p.alg.each,g=this._columns,l=null,k=l=null;for(this.clearData();a.moveNext();)k={},l=a.get_current(),l={item:l,id:l.get_id(),_row:k},e(g,f,l),this._rows.push(k);b(c,d)}function f(a,b,c,d){b=d.id;var f=d._row,g=!1;c=Object.create(a,{rowID:{value:b},dirty:{get:function(){return g}},
value:{get:function(){return"function"===typeof this.macro?this.macro(f):l},set:function(b){a.internal&&(l=b,g=!0,0>a.list._dirtyRows.indexOf(f)&&a.list._dirtyRows.push(f))}}});var l=a.default;if(a.internal)try{l=d.item.get_item(a.internal),a.rowIDs[b]=l,a.values[l]||(a.values[l]=[]),a.values[l].push(b)}catch(k){p.log.warn("Could not load data from column name "+a.internal)}l=e(a,l);f[a.name]=c}function e(a,b){switch(a.type){case "bitflag":case "number":b=p.alg.number(b);break;case "string":case "text":b=
p.alg.string(b)}return b}function g(a,b,c,d){b(c,d)}function q(a,b,c,d){if(a&&d&&d.filterArray&&d.filterArray.length){b=d.filterArray;d=d.exclude;var e,f,g,l;f=!1;for(c=0;!f&&c<b.length;c++)(e=b[c])&&e.column&&"undefined"!==typeof a[e.column]&&(g=a[e.column].value,l=!0,f||"undefined"===typeof e.gt||(e.gt&&"object"===typeof e.gt?(p.alg.each(e.gt,function(a){(l=l&&!(g>a))||this.stop()}),f=l):f=!(g>e.gt)),f||"undefined"===typeof e.geq||(e.geq&&"object"===typeof e.geq?(p.alg.each(e.geq,function(a){(l=
l&&!(g>=a))||this.stop()}),f=l):f=!(g>=e.geq)),f||"undefined"===typeof e.leq||(e.leq&&"object"===typeof e.leq?(p.alg.each(e.leq,function(a){(l=l&&!(g<=a))||this.stop()}),f=l):f=!(g<=e.leq)),f||"undefined"===typeof e.lt||(e.lt&&"object"===typeof e.lt?(p.alg.each(e.lt,function(a){(l=l&&!(g<a))||this.stop()}),f=l):f=!(g<e.lt)),f||"undefined"===typeof e.eq||(e.eq&&"object"===typeof e.eq?(p.alg.each(e.eq,function(a){(l=l&&g!=a)||this.stop()}),f=l):f=g!=e.eq),f||"undefined"===typeof e.seq||(e.seq&&"object"===
typeof e.seq?(p.alg.each(e.seq,function(a){(l=l&&g!==a)||this.stop()}),f=l):f=g!==e.seq),f||"undefined"===typeof e.neq||(e.neq&&"object"===typeof e.neq?(p.alg.each(e.neq,function(a){(l=l&&g==a)||this.stop()}),f=l):f=g==e.neq),f||"undefined"===typeof e.snq||(e.snq&&"object"===typeof e.snq?(p.alg.each(e.snq,function(a){(l=l&&g===a)||this.stop()}),f=l):f=g===e.snq),f||"undefined"===typeof e.and||(e.and&&"object"===typeof e.and?(p.alg.each(e.and,function(a){(l=l&&(g&a)!==a)||this.stop()}),f=l):f=(g&e.and)!==
e.and),f||"undefined"===typeof e.not||(e.not&&"object"===typeof e.not?(p.alg.each(e.not,function(a){(l=l&&0!==(g&a))||this.stop()}),f=l):f=0!==(g&e.not)),f||"undefined"===typeof e.test||(e.test instanceof RegExp?f=!e.test.test(g):e.test&&"object"===typeof e.test&&(p.alg.each(e.test,function(a){(l=l&&!a.test(g))||this.stop()}),f=l)),f||"undefined"===typeof e.notest||(e.notest instanceof RegExp?f=e.notest.test(g):e.notest&&"object"===typeof e.notest&&(p.alg.each(e.notest,function(a){(l=l&&a.test(g))||
this.stop()}),f=l)));(!d&&f||d&&!f)&&this.drop();return this}}function k(a,b,c,d,e){function f(a,b,c){var d=[];p.alg.arrEach(b,function(b){d.push(g(a[b][c]))});return d.join("")}function g(a){return['<ss:Cell><ss:Data ss:Type="String">',a,"</ss:Data></ss:Cell>"].join("")}return['<?xml version="1.0"?><?mso-application progid="Excel.Sheet"?>',['<ss:Workbook xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"><ss:Styles><ss:Style ss:ID="1"><ss:Font ss:Bold="1" /></ss:Style></ss:Styles>',['<ss:Worksheet ss:Name="',
a,'"><ss:Table>',function(a,c){var d=[];d.push('<ss:Row ss:StyleID="1">');p.alg.arrEach(c,function(a){d.push(g(b.exportColumn(a).text))});d.push("</ss:Row>");p.alg.arrEach(a,function(a){d.push("<ss:Row>");d.push(f(a,c,"value"));d.push("</ss:Row>")});return d.join("")}(c,d),"</ss:Table></ss:Worksheet>"].join(""),"</ss:Workbook>"].join("")].join("")}function m(a,b,c){return["\ufeff",function(a,b){var c=[];p.alg.arrEach(b,function(b){c.push(['"',a.exportColumn(b).text||" ",'"'].join(""))});return c.join(",")}(a,
c),"\r\n",function(a,b){function c(a,b,d,h){h.row&&e.push(['"',(h.row[a]||{})[h.type]||"",'"'].join(""))}var d=[],e=null;p.alg.arrEach(a,function(a,h){e=[];p.alg.arrEach(b,c,{row:a,type:"value",r:[]});d.push(e.join(","))});return d.join("\r\n")}(b,c)].join("")}function t(a,b,c,d){this._email=this._user.get_email();this._username=this._user.get_loginName();this._userid=this._user.get_id();p.alg.use(this,b,[c,d])}function u(a,b,c,d){p.alg.use(this,b,[c,d])}function r(a,b,c,d,e,f,g){b=b.getEnumerator();
for(var l=null;b.moveNext();)if(l=b.get_current(),l[a]()===c){Object.defineProperties(this,{_group:{value:l},_id:{value:l.get_id()},_name:{value:l.get_title()}});p.alg.use(this,d,[l]);return}p.alg.use(this,e,[f,g])}function w(a,b,c,d,e){for(var f=!1,g=this._group.get_users().getEnumerator(),l=null;g.moveNext();)if(l=g.get_current(),l.get_id()===a.get_id()){f=!0;break}p.alg.use(this,f?b:c,[d,e])}function l(a,b,c,d){p.alg.use(this,b,[c,d])}var p=window.jspyder;c.getContext=function(a,b){p.alg.use(c.exportContext(a),
b);return c};c.exportContext=function(a){return a?new window.SP.ClientContext(a):window.SP.ClientContext.get_current()};c.list=function(a,b){window.SP||p.log.warn("Ensure that MicrosoftAjax.js, sp.runtime.js, and sp.js have been loaded before using JSpyder SharePoint Interface");var d=Object.create(c.list.fn);a&&(a.url&&(d._url=a.url),a.name&&(d._name=a.name),"function"===typeof a.success&&(d._success=a.success),"function"===typeof a.failure&&(d._failure=a.failure),a.caml&&(d._caml=a.caml));d._columns=
{};d._rows=[];d._dirtyRows=[];p.alg.use(d,b);return d};c.list.fn={_url:"",_name:"",_success:function(){},_failure:function(){},_caml:"<View><Query><Where><Geq><FieldRef Name='ID' /><Value Type='Number'>1</Value></Geq></Where></Query><RowLimit>10000</RowLimit></View>",_columns:{},_rows:[],_dirtyRows:[],get length(){return this._rows.length},addColumn:function(a,b){var d=Object.create(c.column.fn,{list:{value:this},name:{value:a},column:{get:function(){return d}}});p.alg.mergeObj(d,b);"undefined"===
typeof b["default"]&&"number"===d.type&&(d["default"]=0);this._columns[a]=d;return this},addColumns:function(a){p.alg.each(a,function(a,b,c,d){d.addColumn(b,a)},this);return this},exportColumn:function(a){return this._columns[a]?this._columns[a]:Object.create(c.column.fn,{list:{value:this},name:{value:a}})},getColumn:function(a,b){var c=this._columns[a];c&&p.alg.use(this,b,[c]);return this},exportRow:function(a){return this._rows[p.alg.number(a,0)]||null},getRow:function(a,b){var c=this.exportRow(a);
c&&p.alg.use(this,b,[c]);return this},exportRowById:function(a){for(var b=null,c=null,d=0;c=this.exportRow(d++);)if(c.ID.value===a){b=c;break}return b},getRowById:function(a,b){var c=this.exportRowById(a);c&&p.alg.use(this,b,[c]);return this},eachDirtyRow:function(a,b){var c=this._dirtyRows;"function"===typeof a&&p.alg.each(c,a,b);return this},exportRowCount:function(a){return this._rows.length},getRowCount:function(a,b){var c=this.exportRowCount(a);p.alg.use(this,b,[c]);return this},pull:function(b,
d){var e=c.exportContext(this._url),f=e.get_web().get_lists().getByTitle(this._name),l=new window.SP.CamlQuery,k="function"===typeof b?b:this._success,m="function"===typeof d?d:this._failure;l.set_viewXml(this._caml);f=f.getItems(l);e.load(f);e.executeQueryAsync(p.alg.bindFn(this,a,[f,k]),p.alg.bindFn(this,g,[f,m]));return this},query:function(a){var b=c.query(this).reset();return a instanceof Array?b.filters(a):b.filter(a)},clearData:function(){for(this._rows=[];this._dirtyRows.pop(););p.alg.each(this._columns,
function(a){a.rowIDs={};a.values={}});return this},push:function(a,e){var f=c.exportContext(this._url),g=f.get_web().get_lists().getByTitle(this._name),g={clientContext:f,items:[],list:g,self:this};this.eachDirtyRow(this._pushLoopDirtyRows,g);f.executeQueryAsync(p.alg.bindFn(this,d,[g.items,a]),p.alg.bindFn(this,b,[g.items,e]));return this},_pushLoopDirtyRows:function(a,b,c,d){b=a.ID.value;c=c=null;0>b?(c=new window.SP.ListItemCreationInformation,c=d.list.addItem(c),d.newrow=!0):(c=d.list.getItemById(b),
d.newrow=!1);d.listItem=c;p.alg.each(a,d.self._pushLoopDirtyRowColumns,d);d.items.push(c);c.update();d.clientContext.load(c)},_pushLoopDirtyRowColumns:function(a,b,c,d){a.internal&&a.dirty&&"ID"!==a.internal&&d.listItem.set_item(a.internal,a.value)},updateRow:function(a,b){return this.getRowById(a,function(a){p.alg.each(a,this._updateRowEach,p.alg.cloneObj(b))})},_updateRowEach:function(a,b,c,d){b=d[a.name];c=b!==a.value;"undefined"!==typeof b&&c&&(a.value=b)},createRow:function(a){var b=this._columns;
a={row:{},rowID:-1,values:p.alg.mergeObj({},a)};p.alg.each(b,this._createRowEach,a);a.row.ID.value=a.rowID;this._dirtyRows.push(a.row);return this},_createRowEach:function(a,b,c,d){var e=d.row;b=d.values[a.name];d=Object.create(a,{rowID:{value:d.rowID},dirty:{get:function(){return null!==f}},value:{get:function(){return"function"===typeof this.macro?this.macro(e):f},set:function(b){a.internal&&(f=b)}}});var f="undefined"!==typeof b?b:a.default||null;e[a.name]=d},getPermissions:function(a,b){var d=
c.exportContext(this._url),e=d.get_web(),f={currentUser:e.get_currentUser(),web:e};d.load(f.currentUser);d.load(e,"EffectiveBasePermissions");d.executeQueryAsync(p.alg.bindFn(this,this._getPermissionsSuccess,[f,a]),p.alg.bindFn(this,this._getPermissionsSuccess,[null,b]));return this},_getPermissionsSuccess:function(a,b,c,d){var e=this._permissions={};if(a){var f=a.web.get_effectiveBasePermissions();p.alg.each(new window.SP.PermissionKind,function(a,b){e[b]=p.alg.bool(f.has(a))});p.alg.use(this,b,
[this._permissions])}else p.alg.use(this,b,[c,d])}};c.query=function(a){return Object.create(c.query.fn,{_list:{value:a}})};c.query.fn={_list:null,_rows:null,get length(){return this._rows.length},row:function(a){return this._rows[p.alg.number(a)]},reset:function(){this._rows=this._list._rows.slice(0);return this},filter:function(a){a&&p.alg.arrEach(this._rows,q,{filterArray:[a],exclude:!1});return this},filters:function(a){p.alg.arrEach(this._rows,q,{filterArray:a,exclude:!1});return this},excludes:function(a){p.alg.arrEach(this._rows,
q,{filterArray:a,exclude:!0});return this},_cleanRows:function(){this._rows.sort();var a=this._rows.indexOf(null);-1<a&&this._rows.splice(a);return this},data:function(a){p.alg.use(this,a,[this._rows]);return this},sort:function(a,b){p.alg.sortArrayObj(this._rows,b,a,"value");return this},each:function(a){p.alg.arrEach(this._rows,a,this);return this},sum:function(a,b){this.data(function(d){p.alg.each(a,c.query.fn._sum).alg.each(d,c.query.fn._sumRows,a).alg.use(this,b,[a])});return this},_sum:function(a,
b,c){c[b]=a.value||a.default},_sumRows:function(a,b,d,e){p.alg.each(e,c.query.fn._sumColumns,a)},_sumColumns:function(a,b,c,d){if(d=d[b]){var e=d&&d.value;switch(d.type){case "number":c[b]=p.alg.number(e)+p.alg.number(a);break;case "bitflag":c[b]=a&p.alg.number(e);break;default:c[b]=e}}},getValues:function(a,b){p.alg.use(this,b,[this.exportValues(a)]);return this},exportValues:function(a){function b(a,c,d,e){a[e[c].value]=!0}p.alg.each(a,function(a,b,c){c[b]={}});this.each(function(c){p.alg.each(a,
b,c)});p.alg.each(a,function(a,b,c){c[b]=Object.keys(a).sort()});return a},clone:function(){var a=c.query(this._list);a._rows=this._rows.slice(0);return a},toExcelString:function(a,b){return k(a,this._list,this._rows,b)},toCsvString:function(a){return m(this._list,this._rows,a)}};c.column=function(){};c.column.fn={internal:"",text:"",type:"string",default:"",valueOf:function(){return this.value}};c.user=function(a,b,d){a=a||{};var e=c.exportContext(a.url),f=e.get_web(),g=f.get_siteUserInfoList(),
l=null,l=a.userid?g.getById(a.userid):a.login?g.getByLoginName(a.login):a.email?g.getByEmail(a.email):f.get_currentUser(),f=Object.create(p.sp.user.fn,{_user:{value:l}});e.load(l);e.executeQueryAsync(p.alg.bindFn(f,t,[a,b]),p.alg.bindFn(f,u,[a,d]));return f};c.user.getById=function(a,b){return c.user({userid:a,url:b})};c.user.getByLogin=function(a,b){return c.user({login:a,url:b})};c.user.getByEmail=function(a,b){return c.user({email:a,url:b})};c.user.fn={_user:null,_email:null,_userid:null,_username:null,
_url:null,isMemberOfGroup:function(a,b){var d=p.alg.bindFn(this,b,[!0]),e=p.alg.bindFn(this,b,[!1]),f=this._user;c.group(a,function(){this.isMember(f,d,e)},e);return this}};c.group=function(a,b,d){a=a||{};var e=c.exportContext(a.url),f=e.get_web().get_siteGroups(),g=null;if(a&&a.isPrototypeOf(c.group.fn))g=a;else{e.load(f);var g=Object.create(c.group.fn,{_url:{value:p.alg.string(a.url,"")}}),l=p.alg.bindFn(g,d);a=a.name?p.alg.bindFn(g,r,["get_title",f,a.name,b,d]):a.groupid?p.alg.bindFn(g,r,["get_id",
f,a.groupid,b,d]):l;e.executeQueryAsync(a,l)}return g};c.group.fn={_url:null,_group:null,isMember:function(a,b,d){var e=null,e=c.exportContext(this._url);e.get_web();e.load(a);e.load(this._group,"Users");e.executeQueryAsync(p.alg.bindFn(this,w,[a,b,d]),p.alg.bindFn(this,l,[a,d]));return this}};return c});jspyder.extend.fn("storage",function(){function c(a){try{return q(a)}catch(b){return a||null}}function d(a){var b="__jspyder_storage_test__"+(new Date).toString(),c=null;try{c=window[a];if(!c)return!1;c.setItem(b,b);if(c.getItem(b)!==b)return!1;c.removeItem(b);return!0}catch(d){return!1}}function b(b){var l=d(b)?window[b]:Object.create(k);return{exportValue:function(b){return a(l,b)},getValue:function(a,b){e.alg.use(this,b,[this.exportValue(a)]);return this},setValue:function(b,d){var e=b,n,k=g(d),
q=a(l,e),e=r+m(e);n=c(k);l.setItem(e,k);f(l,e,q,n);return this},dropValue:function(b){var c=a(l,b);b=r+m(b);l.removeItem(b);f(l,b,c,null);return this},listen:function(a){window.addEventListener("storage",function(b){b&&b.storageArea&&b.storageArea===l&&e.alg.use(this,a,arguments)},!1)}}}function a(a,b){b=r+m(b);var d=a.getItem(b);return c(d)}function f(a,b,c,d){var e=window.document.createEvent("StorageEvent");e.initStorageEvent("storage",!1,!1,b,c,d,u,a);window.dispatchEvent(e)}var e=this,g=e.alg.bindFn(window.JSON,
window.JSON.stringify),q=e.alg.bindFn(window.JSON,window.JSON.parse),k={data:{},setItem:function(a,b){this.data[a]=b},getItem:function(a){a=this.data[a];return"undefined"===typeof a?null:a},removeItem:function(a){e.data[a]=null}},m=e.alg.bindFn(e.alg,e.alg.string),t=window.location,u=t.toString(),r="jspyder::"+t.protocol+":"+t.hostname+"::"+t.port+"::";return{session:b("sessionStorage"),persist:b("localStorage")}});jspyder.extend.fn("template",function(){function c(a){a&&"object"===typeof a||(a={});var b="";return Object.create(c.fn,{_data:{get:function(){return a}},_compiled:{get:function(){return b}},_setData:{value:function(b,c){b===e&&(a=c)}},_setCompiled:{value:function(a,c){a===e&&(b=c)}}})}function d(a,b){for(var c={data:b,tmp:a,lib:f},e=null,n="",y=0,x;e=w.exec(c.tmp);){y=e.index;e=e[0];x=e.length;n+=c.tmp.substring(0,y);c.tmp=c.tmp.substring(y+x);if(r.test(e)){var y=c,z=void 0;x=[];for(var A=void 0,
B=z=void 0,C=void 0,z=e.match(u)[0].substring(1),e=e.substring(e.indexOf("(")+1,e.lastIndexOf(")"));A=g.exec(e);)C=A[0].length,B=A.length,A=A[B-1],e=e.substring(C),A.search(r)?A.search(k)?A.search(q)?A.search(t)?A.search(m)?x.push(d(A,y.data)):x.push(+A):x.push(d(A,y.data)):x.push(A.substring(1,A.length-1)):x.push(d(A.substring(1,A.length-1),y.data)):x.push(d(A,y.data));(A=y.lib.fetch(z))?(z=A.apply(y.data,x),"undefined"!==typeof z&&null!==z&&(e=z)):e="@"+z+"("+x.join(", ")+")"}t.test(e)&&(y=c.data[e.substring(2,
e.length-1)],e="undefined"===typeof y?e:null!==y?y:"");n+=e}return n+=c.tmp}var b=this;if(!b)return console.error("Attempted to load module js-template without loading JSpyder"),null;var a=b.createRegistry(),f=b.createRegistry(),e=(4294967295*Math.random()|0).toString(32),g=/\s*(`(?:[^`\\]|\\.)*`|"(?:[^"\\]|\\.)*"|\d+(?:\.\d+)?|\$\{\D[a-z0-9_]*\})(?:\s*,\s*(?!\)))?/i,q=/"(?:[^"\\]|\\.)*"/i,k=/`(?:[^`\\]|\\.)*`/i,m=/\d+(?:\.\d+)?/,t=/\$\{\D[a-z0-9_]*\}/i,u=/\@\D[a-z0-9_]*/i,r=/\@\D[a-z0-9_]*\((?:\s*(`(?:[^`\\]|\\.)*`|"(?:[^"\\]|\\.)*"|\d+(?:\.\d+)?|\$\{\D[a-z0-9_]*\})(?:\s*,\s*(?!\)))?)*\)/i,
w=/(\@\D[a-z0-9_]*\((?:\s*(`(?:[^`\\]|\\.)*`|"(?:[^"\\]|\\.)*"|\d+(?:\.\d+)?|\$\{\D[a-z0-9_]*\})(?:\s*,\s*(?!\)))?)*\)|\$\{\D[a-z0-9_]*\})/i;c.fn={compile:function(b,c,d){b=a.fetch(b);return this.compileExplicit(b,c,d)},compileExplicit:function(a,c,f){"function"!==typeof c||f||(f=c,c=null);"undefined"===typeof a&&(a="");var g=Object.create(this._data);b.alg.each(c||{},function(a,b,c,d){d[b]=a},g);a=d(a,g);this._setCompiled(e,a);"function"===typeof f&&f.apply(this,[a]);return this},output:function(){return this._compiled},
outputDom:function(a){return b.dom(this._compiled,a)},storeTemplate:function(c,d){d=b.alg.string(d,"");d=d.replace(/\<\!\-\-[^\<]+\-\-\>/g,"").replace(/\<([^\s\>]+)([^\>]+)\/\>/i,"<$1 $2></$1>");a.stash(c,d);return this},storeTemplateXml:function(a,d){a=b.alg.string(a);if(b.ajax){var e={xmls:new XMLSerializer,fn:d};b.ajax(a).get(c.fn._storeTemplateXml_ajax,e)}else b.log.error("Attempted to call jspyder.template.storeTemplateXml() without loading jspyder.ajax module!");return this},_storeTemplateXml_ajax:function(a,
d){c.fn._storeTemplateXml_ajax="IE"===b.env.browser.name&&9>=b.env.browser.version?function(a,d){var e=c.fn._storeTemplateXml_parseXml(a.responseText);b.dom(e.firstChild).children(c.fn._storeTemplateXml_children,d);b.alg.run(d.fn)}:function(a,d){b.dom(a.responseXML.firstChild).children(c.fn._storeTemplateXml_children,d);b.alg.run(d.fn)};return c.fn._storeTemplateXml_ajax.apply(this,arguments)},_storeTemplateXml_parseXml:function(a){try{var c=null;if("undefined"!=typeof DOMParser)return c=(new DOMParser).parseFromString(a,
"text/xml");if("undefined"!=typeof ActiveXObject)return c=new ActiveXObject("Microsoft.XMLDOM"),c.loadXML(a),c;var d="data:text/xml;charset=utf-8,"+encodeURIComponent(a),e=new XMLHttpRequest;e.open("GET",d,!1);e.send(null);return e.responseXML}catch(f){b.log.error("There was a problem parsing the xml: "+f.message)}return"<templates></templates>"},_storeTemplateXml_children:function(a,b){c.fn.storeTemplate(a.getAttribute("name"),b.xmls.serializeToString(a).replace(/\<[\/]?template[^\>]*\>/g,""))},
getTemplate:function(b,c){a.fetch(b,c);return this},register:function(a,b){"function"===typeof b&&f.stash(a,b);return this},registerSet:function(a){var c=this;b.alg.each(a,function(a,b){c.register(b,a)});return this}};c.storeTemplate=c.fn.storeTempate;c.storeTemplateXml=c.fn.storeTemplateXml;c.getTemplate=c.fn.getTemplate;c.compile=c.fn.compile;c.compileExplicit=c.fn.compileExplicit;c.register=c.fn.register;c.registerSet=c.fn.registerSet;c.registerSet({each:function(a,d,e){a=this[a]||{};var f=Object.create(this),
g="",k=c(a);b.alg.each(a,function(a,b,c,l){f[d]=a;g+=k.compileExplicit(e,f).output()},this);return g},insert_template:function(a){for(var d="",e=Object.create(this),f=1;f<arguments.length;++f)e[arguments[f]]=e[arguments[++f]];e.arguments=b.alg.sliceArray(arguments,1);c(e).compile(a,function(a){d=a});return d},arguments:function(a){a=b.alg.number(a);return this.arguments?this.arguments[a]||"":""},iif:function(a,b,d){var e=c(this);"string"===typeof a&&(a=e.compileExplicit(a).output());return a?e.compileExplicit(b).output():
e.compileExplicit(d).output()},map_size:function(a){return(a=this[a])&&a.length?a.length:"undefined"===typeof a?0:1},add:function(a,c){for(var d=b.alg.number,e=d(a),f=1;f<arguments.length;f++)e+=d(c);return a},"var":function(a,b){if(1===arguments.length)return this[a]||"";this[a]=b;return""},map:function(a){for(var b={},c=1;c<arguments.length;c+=2)b[arguments[c]]=arguments[c+1];this[a]=b;return""},map_item:function(a,b){return(a=this[a])?a[b]:b},js_registry:function(a){a=b.registry.fetch(a);return null===
a||"undefined"===typeof a?"":a},js_log:function(a){console.log(a)},concat:function(a){for(var b=1;b<arguments.length;b++)a+=arguments[b];return a},html:function(a){b.dom("<div>"+a+"</div>").getText(function(b){a=b});return a},escape:function(a){var c=[];a=a.split(/\r?\n/);b.alg.arrEach(a,function(a){var d=[];b.alg.iterate(0,a.length,function(b){d.push("&#",a.charCodeAt(b),";")});c.push(d.join(""))});return c.join("<br />")},tag:function(a,c){a=b.alg.string(a,"br");c=b.alg.string(c,"");var d=/^(area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)\b/i.test(a);
return"<"+a+" "+c+(d?" /":"></"+a)+">"}});return b.template=c});jspyder.extend.fn("tutorial",function(){function c(){var b=Object.create(c.fn,{_window:{value:d.dom('<div class="js-tutorial-viewport"></div>')},_message:{value:d.dom('<div class="js-tutorial-message"></div>')},_obscure:{value:d.dom('<div class="js-tutorial-obscure"></div>')},_messageText:{value:d.dom('<div class="js-tutorial-message-internal"></div>')},_closeButton:{value:d.dom('<i class="js-tutorial-cancel cancel"></i>')},_then:{value:[]}}),a=null;b._next=function(c){a&&"function"===typeof a.callback&&
a.callback.call(b,b._target);a=b._then.pop();"function"===typeof a?a.call(b):b.end()};b._window.on("click",b._next);b._closeButton.on("click",d.alg.bindFn(b,b.end));b._message.append(b._closeButton).append(b._messageText);return b}var d=this;c.fn={_window:null,_target:null,_message:null,_then:null,_running:!1,_searchUntil:1E3,_stepClass:"",start:function(){this._obscure.attach(window.document.body);this._window.attach(window.document.body);this._message.attach(window.document.body);this._closeButton.attach(this._message);
return this},step:function(b,a){b=b||{};var c=b.selector,e=b.message,g=b.onfail||function(){this._next()},q=b.searchUntil||this._searchUntil,k=b["class"]||"",m=function(){var a=0,b=0,m={};this._stepClass&&this._stepClass!==k&&(m[this._stepClass]=!1);k&&(this._stepClass=k,m[k]=!0);var w=d.alg.bindFn(this,function(){if(this._target=window.document.querySelector(c)){this._message.setClasses({"alt-position":!1});var l=this._target.getBoundingClientRect(),k=this._message.exportElement(0).getBoundingClientRect(),
k=l.left>k.left&&l.right<k.right&&l.top>k.top&&k.bottom>k.top;this._window.setCss({top:l.top+"px",left:l.left+"px",height:l.height+"px",width:l.width+"px"});this._messageText.setHtml(e);this._message.setClasses(m);this._message.setClasses({"alt-position":k})}else a=a||(new Date).getTime(),b=(new Date).getTime()-a,b>=q?(d.log.warn("JS-Tutorial could not find selector: "+c),this.use(g)):setTimeout(w,120)});w()};m.callback=b.callback;this._then["boolean"!==typeof a||a?"unshift":"push"](m);this._running||
(this._running=!0,this._next());return this},end:function(){this._window.remove();this._message.remove();this._obscure.remove();return this},use:function(b,a){return d.alg.use(this,b,a)},searchMs:function(b){this._searchUntil=d.alg.number("undefined"===typeof b?c.fn._searchUntil:b);return this}};return c});
